(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-71efd1d7"],{"0cb2":function(e,t,a){var r=a("7b0b"),l=Math.floor,c="".replace,o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,n=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,a,u,s,i){var b=a+e.length,p=u.length,d=n;return void 0!==s&&(s=r(s),d=o),c.call(i,d,(function(r,c){var o;switch(c.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,a);case"'":return t.slice(b);case"<":o=s[c.slice(1,-1)];break;default:var n=+c;if(0===n)return r;if(n>p){var i=l(n/10);return 0===i?r:i<=p?void 0===u[i-1]?c.charAt(1):u[i-1]+c.charAt(1):r}o=u[n-1]}return void 0===o?"":o}))}},"1dde":function(e,t,a){var r=a("d039"),l=a("b622"),c=a("2d00"),o=l("species");e.exports=function(e){return c>=51||!r((function(){var t=[],a=t.constructor={};return a[o]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"25f0":function(e,t,a){"use strict";var r=a("6eeb"),l=a("825a"),c=a("577e"),o=a("d039"),n=a("ad6d"),u="toString",s=RegExp.prototype,i=s[u],b=o((function(){return"/a/b"!=i.call({source:"a",flags:"b"})})),p=i.name!=u;(b||p)&&r(RegExp.prototype,u,(function(){var e=l(this),t=c(e.source),a=e.flags,r=c(void 0===a&&e instanceof RegExp&&!("flags"in s)?n.call(e):a);return"/"+t+"/"+r}),{unsafe:!0})},"2b4f":function(e,t,a){"use strict";a.r(t);var r=a("7a23"),l={class:"custom-edit-wrap"},c=Object(r["createVNode"])("h3",null,"Web白名单规则",-1),o=Object(r["createVNode"])("div",{class:"margin-4x"},null,-1),n={class:"match-box-content"},u={class:"match_key_cascader"},s={class:"match_key_input"},i=Object(r["createTextVNode"])("删除"),b=Object(r["createTextVNode"])("新增"),p={class:"match-box-content"},d={class:"match_key_cascader"},h=Object(r["createTextVNode"])("删除"),f=Object(r["createTextVNode"])("新增"),g={class:"card-item-bottom"},_=Object(r["createTextVNode"])("删除"),m={class:"card-footer"},v=Object(r["createTextVNode"])("新增"),O=Object(r["createVNode"])("div",{class:"margin-4x"},null,-1),j=Object(r["createTextVNode"])("保存 ");function y(e,t){var a=Object(r["resolveComponent"])("el-col"),y=Object(r["resolveComponent"])("el-row"),w=Object(r["resolveComponent"])("el-input"),k=Object(r["resolveComponent"])("el-form-item"),V=Object(r["resolveComponent"])("el-cascader"),M=Object(r["resolveComponent"])("el-button"),x=Object(r["resolveComponent"])("el-option"),B=Object(r["resolveComponent"])("el-select"),C=Object(r["resolveComponent"])("el-card"),N=Object(r["resolveComponent"])("el-switch"),R=Object(r["resolveComponent"])("el-form"),F=Object(r["resolveDirective"])("loading");return Object(r["openBlock"])(),Object(r["createBlock"])("div",l,[Object(r["createVNode"])(y,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(a,{span:24},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(y,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(a,{span:12},{default:Object(r["withCtx"])((function(){return[c]})),_:1}),Object(r["createVNode"])(a,{span:12,class:"text-align-right"},{default:Object(r["withCtx"])((function(){return["group_rule"==e.ruleType?(Object(r["openBlock"])(),Object(r["createBlock"])("a",{key:0,class:"el-button el-button--primary is-plain",href:"/#/group-rule/"+e.uuid+"/sys-web-white-rule"},"返回",8,["href"])):(Object(r["openBlock"])(),Object(r["createBlock"])("a",{key:1,class:"el-button el-button--primary is-plain",href:"/#/sys-web-white-rule/"+e.ruleType},"返回",8,["href"]))]})),_:1})]})),_:1})]})),_:1})]})),_:1}),o,Object(r["withDirectives"])(Object(r["createVNode"])(y,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(a,{span:24},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(R,{class:"custom-edit-form",model:e.webRuleManageForm,rules:e.rules,ref:"webRuleManageForm","label-width":"180px"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(C,{class:"box-card"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])("div",null,[Object(r["createVNode"])(k,{label:"规则名称",prop:"rule_name"},{default:Object(r["withCtx"])((function(){return["new"==e.type?(Object(r["openBlock"])(),Object(r["createBlock"])(w,{key:0,modelValue:e.webRuleManageForm.rule_name,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.webRuleManageForm.rule_name=t}),placeholder:"请输入字母开头，字母或数字组合，仅支持_-两种符号"},null,8,["modelValue"])):(Object(r["openBlock"])(),Object(r["createBlock"])(w,{key:1,modelValue:e.webRuleManageForm.rule_name,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.webRuleManageForm.rule_name=t}),disabled:""},null,8,["modelValue"]))]})),_:1}),Object(r["createVNode"])(k,{label:"规则详情"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(w,{modelValue:e.webRuleManageForm.rule_detail,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.webRuleManageForm.rule_detail=t})},null,8,["modelValue"])]})),_:1}),Object(r["createVNode"])(C,{class:"box-card-rule",shadow:"never"},{default:Object(r["withCtx"])((function(){return[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.ruleBigMatchs,(function(t,a){return Object(r["openBlock"])(),Object(r["createBlock"])("div",{class:"card-item",key:a},[Object(r["createVNode"])(k,{label:"匹配参数"},{default:Object(r["withCtx"])((function(){return[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(t.ruleSmallMatchs,(function(t,l){return Object(r["openBlock"])(),Object(r["createBlock"])("div",{class:"match-box",key:l},[Object(r["createVNode"])("div",n,[Object(r["createVNode"])("div",u,[Object(r["createVNode"])(V,{separator:":",modelValue:t.rule_match_key_list,"onUpdate:modelValue":function(e){return t.rule_match_key_list=e},options:e.optionsMatchKey,props:e.propsMatchKey,onChange:function(r){return e.onChangeRuleMatchs(r,t,a)},clearable:""},null,8,["modelValue","onUpdate:modelValue","options","props","onChange"])]),Object(r["withDirectives"])(Object(r["createVNode"])("div",s,[Object(r["createVNode"])(w,{modelValue:t.rule_match_key,"onUpdate:modelValue":function(e){return t.rule_match_key=e},clearable:"",onChange:function(r){return e.onChangeRuleInput(r,t,a)}},null,8,["modelValue","onUpdate:modelValue","onChange"])],512),[[r["vShow"],t.showInput]])]),Object(r["createVNode"])(M,{onClick:Object(r["withModifiers"])((function(r){return e.removeRuleMatchs(t,a)}),["prevent"])},{default:Object(r["withCtx"])((function(){return[i]})),_:2},1032,["onClick"])])})),128)),Object(r["createVNode"])(M,{onClick:function(t){return e.addRuleMatchs(a)},plain:"",type:"primary"},{default:Object(r["withCtx"])((function(){return[b]})),_:2},1032,["onClick"])]})),_:2},1024),Object(r["createVNode"])(k,{label:"参数处理"},{default:Object(r["withCtx"])((function(){return[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(t.argsPrepocessList,(function(t,l){return Object(r["openBlock"])(),Object(r["createBlock"])("div",{class:"match-box",key:l},[Object(r["createVNode"])("div",p,[Object(r["createVNode"])("div",d,[Object(r["createVNode"])(B,{modelValue:t.args_prepocess_value,"onUpdate:modelValue":function(e){return t.args_prepocess_value=e},placeholder:"Select"},{default:Object(r["withCtx"])((function(){return[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.optionsArgs,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])(x,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:2},1032,["modelValue","onUpdate:modelValue"])])]),Object(r["createVNode"])(M,{onClick:Object(r["withModifiers"])((function(r){return e.removeArgsPrepocess(t,a)}),["prevent"])},{default:Object(r["withCtx"])((function(){return[h]})),_:2},1032,["onClick"])])})),128)),Object(r["createVNode"])(M,{onClick:function(t){return e.addArgsPrepocess(a)},plain:"",type:"primary"},{default:Object(r["withCtx"])((function(){return[f]})),_:2},1032,["onClick"])]})),_:2},1024),Object(r["createVNode"])(k,{label:"匹配方式"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(B,{modelValue:t.match_operator,"onUpdate:modelValue":function(e){return t.match_operator=e},placeholder:"请选择"},{default:Object(r["withCtx"])((function(){return[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.optionsOperator,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])(x,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:2},1032,["modelValue","onUpdate:modelValue"])]})),_:2},1024),Object(r["createVNode"])(k,{label:"匹配内容"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(w,{modelValue:t.match_value,"onUpdate:modelValue":function(e){return t.match_value=e}},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1024),Object(r["createVNode"])("div",g,[Object(r["createVNode"])(M,{type:"danger",plain:"",onClick:Object(r["withModifiers"])((function(a){return e.removeRuleBigMatchs(t)}),["prevent"])},{default:Object(r["withCtx"])((function(){return[_]})),_:2},1032,["onClick"])])])})),128)),Object(r["createVNode"])("div",m,[Object(r["createVNode"])(M,{class:"button",type:"primary",onClick:t[4]||(t[4]=function(t){return e.addRuleBigMatchs(e.bigIndex)})},{default:Object(r["withCtx"])((function(){return[v]})),_:1})])]})),_:1}),Object(r["createVNode"])(k,{label:"执行动作",prop:"rule_action"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(B,{modelValue:e.webRuleManageForm.rule_action,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.webRuleManageForm.rule_action=t}),placeholder:"请选择",onChange:t[6]||(t[6]=function(t){return e.onChangeRuleAction()})},{default:Object(r["withCtx"])((function(){return[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.ruleAction,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])(x,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),"web_check_bypass"==e.webRuleManageForm.rule_action?(Object(r["openBlock"])(),Object(r["createBlock"])(k,{key:0},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(B,{modelValue:e.actionValueList,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.actionValueList=t}),placeholder:"请选择",multiple:""},{default:Object(r["withCtx"])((function(){return[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.optionsCheckBypass,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])(x,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1})):Object(r["createCommentVNode"])("",!0),"web_rule_protection_bypass"==e.webRuleManageForm.rule_action?(Object(r["openBlock"])(),Object(r["createBlock"])(k,{key:1},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(B,{modelValue:e.actionValueList,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.actionValueList=t}),placeholder:"请选择",multiple:""},{default:Object(r["withCtx"])((function(){return[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.optionsWebRuleList,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])(x,{key:e.rule_uuid,label:e.rule_name,value:e.rule_uuid},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1})):Object(r["createCommentVNode"])("",!0),"web_engine_protection_bypass"==e.webRuleManageForm.rule_action?(Object(r["openBlock"])(),Object(r["createBlock"])(k,{key:2},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(B,{modelValue:e.actionValueList,"onUpdate:modelValue":t[9]||(t[9]=function(t){return e.actionValueList=t}),placeholder:"请选择",multiple:""},{default:Object(r["withCtx"])((function(){return[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.optionsEngine,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])(x,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1})):Object(r["createCommentVNode"])("",!0),Object(r["createVNode"])(k,{label:"日志记录"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(N,{modelValue:e.webRuleManageForm.rule_log,"onUpdate:modelValue":t[10]||(t[10]=function(t){return e.webRuleManageForm.rule_log=t}),"active-value":"true","inactive-value":"false"},null,8,["modelValue"])]})),_:1})])]})),_:1})]})),_:1},8,["model","rules"]),O,Object(r["createVNode"])(y,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(a,{span:24},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(y,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(a,{span:12},{default:Object(r["withCtx"])((function(){return["group_rule"==e.ruleType?(Object(r["openBlock"])(),Object(r["createBlock"])("a",{key:0,class:"el-button el-button--primary is-plain",href:"/#/group-rule/"+e.uuid+"/sys-web-white-rule"},"返回",8,["href"])):(Object(r["openBlock"])(),Object(r["createBlock"])("a",{key:1,class:"el-button el-button--primary is-plain",href:"/#/sys-web-white-rule/"+e.ruleType},"返回",8,["href"]))]})),_:1}),Object(r["createVNode"])(a,{span:12,class:"text-align-right"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(M,{type:"primary",onClick:t[11]||(t[11]=function(t){return e.onClickWebRuleProSubmit("webRuleManageForm")}),loading:e.loading},{default:Object(r["withCtx"])((function(){return[j]})),_:1},8,["loading"])]})),_:1})]})),_:1})]})),_:1})]})),_:1})]})),_:1})]})),_:1},512),[[F,e.loadingPage,void 0,{fullscreen:!0,lock:!0}]])])}a("159b"),a("ac1f"),a("1276"),a("5319"),a("4d63"),a("25f0"),a("a434");var w=a("362c"),k=a("6c02"),V={mixins:[w["b"]],data:function(){return{loading:!1,loadingPage:!1,uuid:"",ruleType:"single_rule",webRuleManageForm:{rule_detail:"",action_value:""},type:"edit",optionsMatchKey:[{value:"http_args",label:"http_args",children:[{value:"path",label:"path"},{value:"query_string",label:"query_string"},{value:"method",label:"method"},{value:"src_ip",label:"src_ip"},{value:"raw_body",label:"raw_body"},{value:"version",label:"version"},{value:"scheme",label:"scheme"},{value:"raw_header",label:"raw_header"}]},{value:"header_args",label:"header_args",children:[{value:"host",label:"host"},{value:"cookie",label:"cookie"},{value:"referer",label:"referer"},{value:"user_agent",label:"user_agent"},{value:"default",label:"自定义"}]},{value:"cookie_args",label:"cookie_args",children:[{value:"default",label:"自定义"}]},{value:"uri_args",label:"uri_args",children:[{value:"default",label:"自定义"}]},{value:"post_args",label:"post_args",children:[{value:"default",label:"自定义"}]},{value:"json_post_args",label:"json_post_args",children:[{value:"default",label:"自定义"}]}],propsMatchKey:{expandTrigger:"hover"},ruleBigMatchs:[{ruleSmallMatchs:[{rule_match_key_list:[],rule_match_key:"",showInput:!1}],match_operator:"",match_value:"",checkboxPreprocess:[],argsPrepocessList:[{args_prepocess_value:""}]}],operator:"",optionsOperator:[{value:"rx",label:"正则匹配"},{value:"str_prefix",label:"前缀匹配"},{value:"str_suffix",label:"后缀匹配"},{value:"str_contain",label:"包含"},{value:"str_ncontain",label:"不包含"},{value:"str_eq",label:"等于"},{value:"str_neq",label:"不等于"},{value:"gt",label:"数字大于"},{value:"lt",label:"数字小于"},{value:"eq",label:"数字等于"},{value:"neq",label:"数字不等于"}],optionsArgs:[{value:"lowerCase",label:"小写处理",key:"lowerCase"},{value:"base64Decode",label:"BASE64解码",key:"base64Decode"},{value:"length",label:"长度计算",key:"length"},{value:"uriDecode",label:"URL解码",key:"uriDecode"},{value:"uniDecode",label:"UNICODE解码",key:"uniDecode"},{value:"hexDecode",label:"十六进制解码",key:"hexDecode"},{value:"none",label:"不处理",key:"none"},{value:"type",label:"获取数据类型",key:"type"}],ruleAction:[{value:"allow",label:"放行请求"},{value:"web_check_bypass",label:"基础防护功能加白"},{value:"web_rule_protection_bypass",label:"Web防护规则加白"},{value:"web_engine_protection_bypass",label:"Web防护引擎功能加白"}],optionsCheckBypass:[{value:"web_rule_protection_bypass",label:"Web防护引擎加白"},{value:"web_engine_protection_bypass",label:"Web防护规则加白"}],optionsEngine:[{value:"sql_check_bypass",label:"SQL注入防护加白"},{value:"xss_check_bypass",label:"XSS防护加白"},{value:"command_inject_check_bypass",label:"命令注入防护加白"},{value:"webshell_update_check_bypass",label:"WebShell上传防护加白"},{value:"sensitive_file_check_bypass",label:"敏感文件泄露防护加白"},{value:"path_traversal_check_bypass",label:"路径穿越防护加白"},{value:"high_nday_check_bypass",label:"高危Nday防护加白"}],optionsWebRuleList:[],actionValueList:[]}},computed:{rules:function(){return{rule_name:[{required:!0,message:"请输入规则名称",trigger:["blur","change"]},{validator:w["g"],trigger:["blur","change"]}],action_value:[{required:!0,message:"请选择匹配方式",trigger:"change"}],match_value:[{required:!0,message:"请输入匹配内容",trigger:["blur","change"]}],rule_action:[{required:!0,message:"请选择执行动作",trigger:"change"}],checkboxPreprocess:[{type:"array",required:!0,message:"请至少选择一个",trigger:"change"}]}}},mounted:function(){var e=this,t=Object(k["c"])();e.uuid=t.params.uuid,e.ruleType=t.params.ruleType,e.type=t.params.type,"new"==e.type?e.loadingPage=!1:(e.loadingPage=!1,e.getData())},methods:{getData:function(){var e=this,t="/waf/waf_get_sys_web_white_rule",a={rule_uuid:e.uuid,rule_type:e.ruleType};"group_rule"==e.ruleType&&(a={rule_uuid:e.type,rule_type:e.ruleType}),Object(w["a"])("post",t,a,(function(t){e.loadingPage=!1,e.webRuleManageForm=t.data.message;var a=JSON.parse(e.webRuleManageForm.rule_matchs),r=[];for(var l in a){var c=[],o=[],n=["header_args","cookie_args","uri_args","post_args","json_post_args"];for(var u in a[l].match_args){var s=a[l].match_args[u],i=s.key,b=s.value,p="false";n.indexOf(i)>-1&&(p="true"),c.push({rule_match_key_list:[i,b],rule_match_key:i+":"+b,showInput:p})}for(var d in a[l].args_prepocess)o.push({args_prepocess_value:a[l].args_prepocess[d]});r.push({ruleSmallMatchs:c,argsPrepocessList:o,match_operator:a[l].match_operator,match_value:a[l].match_value})}e.ruleBigMatchs=r,"web_rule_protection_bypass"==e.webRuleManageForm.rule_action&&e.onChangeRuleAction(),e.actionValueList=JSON.parse(e.webRuleManageForm.action_value)}),(function(){e.loadingPage=!1}),"no-message")},onChangeRuleAction:function(){var e=this;e.actionValueList=[];var t="/waf/waf_get_sys_web_rule_protection_list",a={rule_type:e.ruleType};"group_rule"==e.ruleType&&(t="/waf/waf_get_sys_web_rule_protection_group_list",a={}),"web_rule_protection_bypass"==e.webRuleManageForm.rule_action&&Object(w["a"])("post",t,a,(function(t){e.optionsWebRuleList=t.data.message,"group_rule"==e.ruleType&&e.optionsWebRuleList.forEach((function(e){e.rule_uuid=e.rule_group_uuid,e.rule_name=e.rule_group_name}))}),(function(){}),"no-message")},onClickWebRuleProSubmit:function(e){var t=this,a=[];if(0==t.ruleBigMatchs.length)return t.$message({showClose:!0,message:"请输入详细规则",type:"error"}),!1;for(var r in t.ruleBigMatchs){var l=[],c=[];if(0==t.ruleBigMatchs[r].ruleSmallMatchs.length)return t.$message({showClose:!0,message:"请选择匹配参数",type:"error"}),!1;for(var o in t.ruleBigMatchs[r].ruleSmallMatchs){var n=t.ruleBigMatchs[r].ruleSmallMatchs[o];if(""==n.rule_match_key)return t.$message({showClose:!0,message:"请选择匹配参数",type:"error"}),!1;var u="",s=[],i="",b="";n.rule_match_key&&(s=n.rule_match_key.split(":")),s.length>0&&(i=s[0],b=n.rule_match_key.replace(new RegExp(i+":"),""),u='{"key":"'+i+'" , "value":"'+b+'"}'),l.push(JSON.parse(u))}if(0==t.ruleBigMatchs[r].argsPrepocessList.length)return t.$message({showClose:!0,message:"请选择参数处理",type:"error"}),!1;for(var p in t.ruleBigMatchs[r].argsPrepocessList){if(""==t.ruleBigMatchs[r].argsPrepocessList[p].args_prepocess_value)return t.$message({showClose:!0,message:"请选择参数处理",type:"error"}),!1;c.push(t.ruleBigMatchs[r].argsPrepocessList[p].args_prepocess_value)}if(""==t.ruleBigMatchs[r].match_operator)return t.$message({showClose:!0,message:"请选择匹配方式",type:"error"}),!1;if(""==t.ruleBigMatchs[r].match_value)return t.$message({showClose:!0,message:"请输入匹配内容",type:"error"}),!1;a.push({match_args:l,args_prepocess:c,match_operator:t.ruleBigMatchs[r].match_operator,match_value:t.ruleBigMatchs[r].match_value})}if("web_check_bypass"==t.webRuleManageForm.rule_action&&0==t.actionValueList.length)return t.$message({message:"请选择基础防护功能加白类型",type:"error"}),!1;if("web_rule_protection_bypass"==t.webRuleManageForm.rule_action&&0==t.actionValueList.length)return t.$message({message:"请选择加白的规则",type:"error"}),!1;if("web_engine_protection_bypass"==t.webRuleManageForm.rule_action&&0==t.actionValueList.length)return t.$message({message:"请选择加白的引擎",type:"error"}),!1;var d="/waf/waf_edit_sys_web_white_rule";"new"==t.type?(d="/waf/waf_create_sys_web_white_rule","group_rule"==t.ruleType&&(t.webRuleManageForm.rule_group_uuid=t.uuid)):(t.webRuleManageForm.rule_uuid=t.uuid,"group_rule"==t.ruleType&&(t.webRuleManageForm.rule_uuid=t.type)),t.webRuleManageForm.rule_type=t.ruleType,t.webRuleManageForm.rule_matchs=JSON.stringify(a),t.webRuleManageForm.action_value=JSON.stringify(t.actionValueList),this.$refs[e].validate((function(e){e&&(t.loading=!0,Object(w["a"])("post",d,t.webRuleManageForm,(function(e){t.loading=!1,"group_rule"==t.ruleType?window.location.href="/#/group-rule/"+t.uuid+"/sys-web-white-rule":window.location.href="/#/sys-web-white-rule/"+t.ruleType}),(function(){t.loading=!1})))}))},removeArgsPrepocess:function(e,t){var a=this.ruleBigMatchs[t].argsPrepocessList.indexOf(e);-1!=a&&this.ruleBigMatchs[t].argsPrepocessList.splice(a,1)},addArgsPrepocess:function(e){this.ruleBigMatchs[e].argsPrepocessList.push({args_prepocess_value:""})},addRuleMatchs:function(e){this.ruleBigMatchs[e].ruleSmallMatchs.push({rule_match_key:"",rule_match_key_list:[],showInput:!1})},removeRuleMatchs:function(e,t){var a=this.ruleBigMatchs[t].ruleSmallMatchs.indexOf(e);-1!=a&&this.ruleBigMatchs[t].ruleSmallMatchs.splice(a,1)},removeRuleBigMatchs:function(e){var t=this.ruleBigMatchs.indexOf(e);-1!=t&&this.ruleBigMatchs.splice(t,1)},addRuleBigMatchs:function(e){this.ruleBigMatchs.push({ruleSmallMatchs:[{rule_match_key_list:[],rule_match_key:"",showInput:!1}],match_operator:"",match_value:"",checkboxPreprocess:[],argsPrepocessList:[{args_prepocess_value:""}]})},onChangeRuleMatchs:function(e,t,a){var r=this.ruleBigMatchs[a].ruleSmallMatchs.indexOf(t);"default"==e[1]?(this.ruleBigMatchs[a].ruleSmallMatchs[r].showInput=!0,this.ruleBigMatchs[a].ruleSmallMatchs[r].rule_match_key=e[0]+":"):this.ruleBigMatchs[a].ruleSmallMatchs[r].rule_match_key=e[0]+":"+e[1]},onChangeRuleInput:function(e,t,a){var r=this.ruleBigMatchs[a].ruleSmallMatchs.indexOf(t);""==e?(this.ruleBigMatchs[a].ruleSmallMatchs[r].showInput=!1,this.ruleBigMatchs[a].ruleSmallMatchs[r].rule_match_key="",this.ruleBigMatchs[a].ruleSmallMatchs[r].rule_match_key_list=[]):this.ruleBigMatchs[a].ruleSmallMatchs[r].rule_match_key=e}}};a("3963");V.render=y;t["default"]=V},3963:function(e,t,a){"use strict";a("434a")},"434a":function(e,t,a){},"4d63":function(e,t,a){var r=a("83ab"),l=a("da84"),c=a("94ca"),o=a("7156"),n=a("9112"),u=a("9bf2").f,s=a("241c").f,i=a("44e7"),b=a("577e"),p=a("ad6d"),d=a("9f7f"),h=a("6eeb"),f=a("d039"),g=a("5135"),_=a("69f3").enforce,m=a("2626"),v=a("b622"),O=a("fce3"),j=a("107c"),y=v("match"),w=l.RegExp,k=w.prototype,V=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,M=/a/g,x=/a/g,B=new w(M)!==M,C=d.UNSUPPORTED_Y,N=r&&(!B||C||O||j||f((function(){return x[y]=!1,w(M)!=M||w(x)==x||"/a/i"!=w(M,"i")}))),R=function(e){for(var t,a=e.length,r=0,l="",c=!1;r<=a;r++)t=e.charAt(r),"\\"!==t?c||"."!==t?("["===t?c=!0:"]"===t&&(c=!1),l+=t):l+="[\\s\\S]":l+=t+e.charAt(++r);return l},F=function(e){for(var t,a=e.length,r=0,l="",c=[],o={},n=!1,u=!1,s=0,i="";r<=a;r++){if(t=e.charAt(r),"\\"===t)t+=e.charAt(++r);else if("]"===t)n=!1;else if(!n)switch(!0){case"["===t:n=!0;break;case"("===t:V.test(e.slice(r+1))&&(r+=2,u=!0),l+=t,s++;continue;case">"===t&&u:if(""===i||g(o,i))throw new SyntaxError("Invalid capture group name");o[i]=!0,c.push([i,s]),u=!1,i="";continue}u?i+=t:l+=t}return[l,c]};if(c("RegExp",N)){for(var L=function(e,t){var a,r,l,c,u,s,d=this instanceof L,h=i(e),f=void 0===t,g=[],m=e;if(!d&&h&&f&&e.constructor===L)return e;if((h||e instanceof L)&&(e=e.source,f&&(t="flags"in m?m.flags:p.call(m))),e=void 0===e?"":b(e),t=void 0===t?"":b(t),m=e,O&&"dotAll"in M&&(r=!!t&&t.indexOf("s")>-1,r&&(t=t.replace(/s/g,""))),a=t,C&&"sticky"in M&&(l=!!t&&t.indexOf("y")>-1,l&&(t=t.replace(/y/g,""))),j&&(c=F(e),e=c[0],g=c[1]),u=o(w(e,t),d?this:k,L),(r||l||g.length)&&(s=_(u),r&&(s.dotAll=!0,s.raw=L(R(e),a)),l&&(s.sticky=!0),g.length&&(s.groups=g)),e!==m)try{n(u,"source",""===m?"(?:)":m)}catch(v){}return u},S=function(e){e in L||u(L,e,{configurable:!0,get:function(){return w[e]},set:function(t){w[e]=t}})},P=s(w),T=0;P.length>T;)S(P[T++]);k.constructor=L,L.prototype=k,h(l,"RegExp",L)}m("RegExp")},5319:function(e,t,a){"use strict";var r=a("d784"),l=a("d039"),c=a("825a"),o=a("a691"),n=a("50c4"),u=a("577e"),s=a("1d80"),i=a("8aa5"),b=a("0cb2"),p=a("14c3"),d=a("b622"),h=d("replace"),f=Math.max,g=Math.min,_=function(e){return void 0===e?e:String(e)},m=function(){return"$0"==="a".replace(/./,"$0")}(),v=function(){return!!/./[h]&&""===/./[h]("a","$0")}(),O=!l((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));r("replace",(function(e,t,a){var r=v?"$":"$0";return[function(e,a){var r=s(this),l=void 0==e?void 0:e[h];return void 0!==l?l.call(e,r,a):t.call(u(r),e,a)},function(e,l){var s=c(this),d=u(e);if("string"===typeof l&&-1===l.indexOf(r)&&-1===l.indexOf("$<")){var h=a(t,s,d,l);if(h.done)return h.value}var m="function"===typeof l;m||(l=u(l));var v=s.global;if(v){var O=s.unicode;s.lastIndex=0}var j=[];while(1){var y=p(s,d);if(null===y)break;if(j.push(y),!v)break;var w=u(y[0]);""===w&&(s.lastIndex=i(d,n(s.lastIndex),O))}for(var k="",V=0,M=0;M<j.length;M++){y=j[M];for(var x=u(y[0]),B=f(g(o(y.index),d.length),0),C=[],N=1;N<y.length;N++)C.push(_(y[N]));var R=y.groups;if(m){var F=[x].concat(C,B,d);void 0!==R&&F.push(R);var L=u(l.apply(void 0,F))}else L=b(x,d,B,C,R,l);B>=V&&(k+=d.slice(V,B)+L,V=B+x.length)}return k+d.slice(V)}]}),!O||!m||v)},7156:function(e,t,a){var r=a("861d"),l=a("d2bb");e.exports=function(e,t,a){var c,o;return l&&"function"==typeof(c=t.constructor)&&c!==a&&r(o=c.prototype)&&o!==a.prototype&&l(e,o),e}},8418:function(e,t,a){"use strict";var r=a("a04b"),l=a("9bf2"),c=a("5c6c");e.exports=function(e,t,a){var o=r(t);o in e?l.f(e,o,c(0,a)):e[o]=a}},a434:function(e,t,a){"use strict";var r=a("23e7"),l=a("23cb"),c=a("a691"),o=a("50c4"),n=a("7b0b"),u=a("65f0"),s=a("8418"),i=a("1dde"),b=i("splice"),p=Math.max,d=Math.min,h=9007199254740991,f="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!b},{splice:function(e,t){var a,r,i,b,g,_,m=n(this),v=o(m.length),O=l(e,v),j=arguments.length;if(0===j?a=r=0:1===j?(a=0,r=v-O):(a=j-2,r=d(p(c(t),0),v-O)),v+a-r>h)throw TypeError(f);for(i=u(m,r),b=0;b<r;b++)g=O+b,g in m&&s(i,b,m[g]);if(i.length=r,a<r){for(b=O;b<v-r;b++)g=b+r,_=b+a,g in m?m[_]=m[g]:delete m[_];for(b=v;b>v-r+a;b--)delete m[b-1]}else if(a>r)for(b=v-r;b>O;b--)g=b+r-1,_=b+a-1,g in m?m[_]=m[g]:delete m[_];for(b=0;b<a;b++)m[b+O]=arguments[b+2];return m.length=v-r+a,i}})}}]);
//# sourceMappingURL=chunk-71efd1d7.js.map