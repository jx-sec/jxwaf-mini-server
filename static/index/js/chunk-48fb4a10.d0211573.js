(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48fb4a10"],{"1dde":function(e,t,o){var r=o("d039"),i=o("b622"),n=o("2d00"),a=i("species");e.exports=function(e){return n>=51||!r((function(){var t=[],o=t.constructor={};return o[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},2532:function(e,t,o){"use strict";var r=o("23e7"),i=o("5a34"),n=o("1d80"),a=o("577e"),c=o("ab13");r({target:"String",proto:!0,forced:!c("includes")},{includes:function(e){return!!~a(n(this)).indexOf(a(i(e)),arguments.length>1?arguments[1]:void 0)}})},4414:function(e,t,o){"use strict";o.r(t);o("4de4"),o("caad"),o("2532"),o("b0c0");var r=o("7a23"),i=Object(r["createVNode"])("h3",null,"流量转发配置",-1),n={class:"domain-search-input"},a=Object(r["createTextVNode"])("新增"),c={class:"demo-block"},l=Object(r["createTextVNode"])("编辑"),d=Object(r["createVNode"])("p",null,"确定删除吗？",-1),u={style:{"text-align":"right",margin:"0"}},s=Object(r["createTextVNode"])("取消"),f=Object(r["createTextVNode"])("确定 "),b=Object(r["createTextVNode"])("删除"),p={key:0},m={class:"match_key_title"},h={class:"match-box-type"},j={class:"match-box-content"},O=Object(r["createTextVNode"])("删除"),_=Object(r["createTextVNode"])("新增"),V=Object(r["createVNode"])("i",{class:"el-icon-plus"},null,-1),g=Object(r["createTextVNode"])("取消"),y=Object(r["createTextVNode"])("确定");function w(e,t){var o=Object(r["resolveComponent"])("el-col"),w=Object(r["resolveComponent"])("el-row"),v=Object(r["resolveComponent"])("el-divider"),C=Object(r["resolveComponent"])("el-input"),x=Object(r["resolveComponent"])("el-button"),k=Object(r["resolveComponent"])("el-table-column"),N=Object(r["resolveComponent"])("el-popover"),I=Object(r["resolveComponent"])("el-table"),F=Object(r["resolveComponent"])("el-form-item"),L=Object(r["resolveComponent"])("el-switch"),T=Object(r["resolveComponent"])("el-option"),B=Object(r["resolveComponent"])("el-select"),S=Object(r["resolveComponent"])("el-tag"),M=Object(r["resolveComponent"])("el-form"),U=Object(r["resolveComponent"])("el-dialog");return Object(r["openBlock"])(),Object(r["createBlock"])(w,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(o,{span:24},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(w,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(o,{span:24},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(w,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(o,{span:12},{default:Object(r["withCtx"])((function(){return[i]})),_:1})]})),_:1})]})),_:1})]})),_:1}),Object(r["createVNode"])(v),Object(r["createVNode"])(w,{class:"text-align-right"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])("div",n,[Object(r["createVNode"])(C,{placeholder:"请输入名称进行搜索","prefix-icon":"el-icon-search",modelValue:e.domainSearch,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.domainSearch=t})},null,8,["modelValue"])]),Object(r["createVNode"])(x,{type:"primary",onClick:t[2]||(t[2]=function(t){return e.onClickCreateIdentity()})},{default:Object(r["withCtx"])((function(){return[a]})),_:1})]})),_:1}),Object(r["createVNode"])("div",c,[Object(r["createVNode"])(I,{data:e.tableData.filter((function(t){return!e.domainSearch||t.name.toLowerCase().includes(e.domainSearch.toLowerCase())})),style:{width:"100%"}},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(k,{prop:"name",label:"名称"}),Object(r["createVNode"])(k,{prop:"detail",label:"详情"}),Object(r["createVNode"])(k,{prop:"traffic_forward_ip",label:"转发地址"}),Object(r["createVNode"])(k,{prop:"traffic_forward_port",label:"转发端口"}),Object(r["createVNode"])(k,{label:"操作",align:"right"},{default:Object(r["withCtx"])((function(t){return[Object(r["createVNode"])(x,{size:"mini",onClick:function(o){return e.handleEdit(t.row)},class:"button-block",type:"text",loading:t.row.loading},{default:Object(r["withCtx"])((function(){return[l]})),_:2},1032,["onClick","loading"]),Object(r["createVNode"])(N,{placement:"top",width:"160",visible:t.row.isVisiblePopover,"onUpdate:visible":function(e){return t.row.isVisiblePopover=e}},{reference:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(x,{type:"text",size:"mini",onClick:function(e){return t.row.isVisiblePopover=!0}},{default:Object(r["withCtx"])((function(){return[b]})),_:2},1032,["onClick"])]})),default:Object(r["withCtx"])((function(){return[d,Object(r["createVNode"])("div",u,[Object(r["createVNode"])(x,{size:"mini",type:"text",onClick:function(e){return t.row.isVisiblePopover=!1}},{default:Object(r["withCtx"])((function(){return[s]})),_:2},1032,["onClick"]),Object(r["createVNode"])(x,{type:"primary",size:"mini",onClick:function(o){return e.handleDelete(t.row)},loading:e.loading},{default:Object(r["withCtx"])((function(){return[f]})),_:2},1032,["onClick","loading"])])]})),_:2},1032,["visible","onUpdate:visible"])]})),_:1})]})),_:1},8,["data"])])]})),_:1}),Object(r["createVNode"])(U,{title:e.domainTitle,modelValue:e.dialogIdentityFormVisible,"onUpdate:modelValue":t[12]||(t[12]=function(t){return e.dialogIdentityFormVisible=t}),width:"820px","close-on-click-modal":!1,onClosed:e.dialogClose},{footer:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(x,{onClick:t[10]||(t[10]=function(t){return e.dialogIdentityFormVisible=!1})},{default:Object(r["withCtx"])((function(){return[g]})),_:1}),Object(r["createVNode"])(x,{type:"primary",onClick:t[11]||(t[11]=function(t){return e.onClickIdentitySubmit("identityForm")}),loading:e.loading},{default:Object(r["withCtx"])((function(){return[y]})),_:1},8,["loading"])]})),default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(M,{class:"form-tag-dialog identity-edit-form ",model:e.identityForm,size:"mini","label-position":"left","label-width":"130px",rules:e.rules,ref:"identityForm"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(F,{label:"名称",prop:"name",key:"1"},{default:Object(r["withCtx"])((function(){return["new"==e.domainType?(Object(r["openBlock"])(),Object(r["createBlock"])(C,{key:0,modelValue:e.identityForm.name,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.identityForm.name=t}),placeholder:"请输入字母开头，只包含字母、数字、下划线“_”、中横线“-”"},null,8,["modelValue"])):Object(r["createCommentVNode"])("",!0),"edit"==e.domainType?(Object(r["openBlock"])(),Object(r["createBlock"])(C,{key:1,modelValue:e.identityForm.name,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.identityForm.name=t}),disabled:"disabled"},null,8,["modelValue"])):Object(r["createCommentVNode"])("",!0)]})),_:1}),Object(r["createVNode"])(F,{label:"详情",key:"2"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(C,{modelValue:e.identityForm.detail,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.identityForm.detail=t}),placeholder:"请输入详情"},null,8,["modelValue"])]})),_:1}),Object(r["createVNode"])(F,{label:"自定义header头",key:"3"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(L,{modelValue:e.identityForm.set_request_header_status,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.identityForm.set_request_header_status=t}),"active-value":"true","inactive-value":"false"},null,8,["modelValue"])]})),_:1}),"true"==e.identityForm.set_request_header_status?(Object(r["openBlock"])(),Object(r["createBlock"])("div",p,[Object(r["createVNode"])(F,{label:"响应头配置",class:"longer-cascader traffic-forward-item"},{default:Object(r["withCtx"])((function(){return[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.ruleConfigMatchs,(function(t,o){return Object(r["openBlock"])(),Object(r["createBlock"])("div",{class:"match-box",key:"matchs"+o},[Object(r["createVNode"])("div",m,[Object(r["createVNode"])(C,{modelValue:t.key,"onUpdate:modelValue":function(e){return t.key=e},placeholder:"key"},null,8,["modelValue","onUpdate:modelValue"])]),Object(r["createVNode"])("div",h,[Object(r["createVNode"])(B,{modelValue:t.type,"onUpdate:modelValue":function(e){return t.type=e},placeholder:"请选择"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(T,{label:"设置值",value:"set_value"}),Object(r["createVNode"])(T,{label:"删除值",value:"del_value"})]})),_:2},1032,["modelValue","onUpdate:modelValue"])]),Object(r["createVNode"])("div",j,[Object(r["withDirectives"])(Object(r["createVNode"])(C,{modelValue:t.value,"onUpdate:modelValue":function(e){return t.value=e},placeholder:"value"},null,8,["modelValue","onUpdate:modelValue"]),[[r["vShow"],"set_value"==t.type]])]),Object(r["createVNode"])(x,{onClick:Object(r["withModifiers"])((function(o){return e.removeConfigMatchs(t,e.bigIndex)}),["prevent"])},{default:Object(r["withCtx"])((function(){return[O]})),_:2},1032,["onClick"])])})),128)),Object(r["createVNode"])(x,{onClick:t[7]||(t[7]=function(t){return e.addConfigMatchs(e.bigIndex)}),plain:"",type:"primary",class:"button-new"},{default:Object(r["withCtx"])((function(){return[_]})),_:1})]})),_:1})])):Object(r["createCommentVNode"])("",!0),Object(r["createVNode"])(F,{label:"转发地址",key:"4"},{default:Object(r["withCtx"])((function(){return[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.sourceIpList,(function(t,o){return Object(r["openBlock"])(),Object(r["createBlock"])(S,{key:o,closable:"","disable-transitions":!1,onClose:function(o){return e.handleCloseSourceIpList(t)}},{default:Object(r["withCtx"])((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(t),1)]})),_:2},1032,["onClose"])})),128)),e.sourceIpListVisible?(Object(r["openBlock"])(),Object(r["createBlock"])(C,{key:0,class:"input-new-tag node-ip-list",modelValue:e.sourceIpListValue,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.sourceIpListValue=t}),ref:"saveTagSourceIpList",size:"mini",onKeyup:Object(r["withKeys"])(e.handleSourceIpListConfirm,["enter"]),onBlur:e.handleSourceIpListConfirm},null,8,["modelValue","onKeyup","onBlur"])):(Object(r["openBlock"])(),Object(r["createBlock"])(x,{key:1,class:"button-new-tag",size:"small",onClick:e.showSourceIpList},{default:Object(r["withCtx"])((function(){return[V]})),_:1},8,["onClick"]))]})),_:1}),Object(r["createVNode"])(F,{label:"转发端口",prop:"traffic_forward_port",key:"5"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(C,{modelValue:e.identityForm.traffic_forward_port,"onUpdate:modelValue":t[9]||(t[9]=function(t){return e.identityForm.traffic_forward_port=t})},null,8,["modelValue"])]})),_:1})]})),_:1},8,["model","rules"])]})),_:1},8,["title","modelValue","onClosed"])]})),_:1})}o("a434"),o("159b"),o("a15b"),o("ac1f"),o("1276");var v=o("362c"),C={mixins:[v["b"]],data:function(){return{domainTitle:"新增",domainType:"new",domainSearch:"",dialogIdentityFormVisible:!1,loading:!1,identityForm:{name:"",detail:"",traffic_forward_ip:"",traffic_forward_port:"80"},tableData:[],sourceIpList:[],sourceIpListVisible:!1,sourceIpListValue:"",flagTag:!0,ruleConfigMatchs:[{key:"",type:"set_value",value:""}]}},computed:{rules:function(){return{name:[{required:!0,message:"请输入字母开头，只包含字母、数字、下划线“_”、中横线“-”",trigger:["blur","change"]},{validator:v["h"],trigger:["blur","change"]}],traffic_forward_port:[{required:!0,message:"请输入转发端口信息",trigger:["blur","change"]},{validator:v["e"],trigger:["blur","change"]}]}}},mounted:function(){this.getData()},methods:{handleCloseSourceIpList:function(e){this.sourceIpList.splice(this.sourceIpList.indexOf(e),1)},showSourceIpList:function(){var e=this;this.sourceIpListVisible=!0,this.$nextTick((function(t){e.$refs.saveTagSourceIpList.$refs.input.focus()}))},handleSourceIpListConfirm:function(){var e=this,t=this.sourceIpListValue,o=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;e.flagTag&&(e.flagTag=!1,t?o.test(t)?Object(v["a"])("post","/ip_check",{ip:t},(function(o){o.data.result?(e.sourceIpList.push(t),e.sourceIpListVisible=!1,e.sourceIpListValue=""):e.$message({showClose:!0,message:"请输入正确的IP地址",type:"error"})}),(function(){}),"no-message"):e.$message({showClose:!0,message:"请输入转发IP地址",type:"error"}):(e.sourceIpListVisible=!1,e.sourceIpListValue=""),setTimeout((function(){e.flagTag=!0}),50))},getData:function(){var e=this;Object(v["a"])("get","/waf/waf_get_sys_traffic_forward_list",{},(function(t){e.tableData=t.data.message,e.tableData.forEach((function(e){e.isVisiblePopover=!1}))}),(function(){}))},dialogClose:function(){this.identityForm={name:"",detail:"",set_request_header_status:"false",traffic_forward_ip:"",traffic_forward_port:"80"},this.ruleConfigMatchs=[{key:"",value:"",type:"set_value"}],this.sourceIpListVisible=!1,this.sourceIpListValue="",this.sourceIpList=[],this.$refs["identityForm"].resetFields()},onClickIdentitySubmit:function(e){var t=this,o="/waf/waf_create_sys_traffic_forward";return"edit"==t.domainType&&(o="/waf/waf_edit_sys_traffic_forward"),0==t.sourceIpList.length?(t.$message({message:"IP不能为空",type:"error"}),!1):"true"==t.identityForm.set_request_header_status&&0==t.ruleConfigMatchs.length?(t.$message({message:"请对自定义header头进行配置",type:"error"}),!1):(t.identityForm.set_request_header_value=JSON.stringify(t.ruleConfigMatchs),t.identityForm.traffic_forward_ip=t.sourceIpList.join(","),void this.$refs[e].validate((function(e){e&&(t.loading=!0,Object(v["a"])("post",o,t.identityForm,(function(e){t.loading=!1,t.dialogIdentityFormVisible=!1,t.sourceIpListVisible=!1,t.sourceIpListValue="",t.sourceIpList=[],t.getData()}),(function(){t.loading=!1})))})))},onClickCreateIdentity:function(){var e=this;e.domainTitle="新增",e.domainType="new",e.dialogIdentityFormVisible=!0},handleEdit:function(e){var t=this;e.loading=!0,Object(v["a"])("post","/waf/waf_get_sys_traffic_forward",{name:e.name},(function(o){e.loading=!1;var r=o.data.message;if(t.identityForm.name=r.name,t.identityForm.detail=r.detail,t.identityForm.traffic_forward_ip=r.traffic_forward_ip,t.identityForm.traffic_forward_port=r.traffic_forward_port,t.sourceIpList=r.traffic_forward_ip?r.traffic_forward_ip.split(","):[],t.identityForm.set_request_header_status=r.set_request_header_status,t.identityForm.set_request_header_value=r.set_request_header_value,"true"==t.identityForm.set_request_header_status){var i=JSON.parse(t.identityForm.set_request_header_value),n=[];for(var a in i){var c=i[a];n.push({key:c.key,value:c.value,type:c.type})}t.ruleConfigMatchs=n}t.domainTitle="编辑",t.domainType="edit",t.dialogIdentityFormVisible=!0}),(function(){e.loading=!1}),"no-message")},handleDelete:function(e){var t=this;t.loading=!0,Object(v["a"])("post","/waf/waf_del_sys_traffic_forward",{name:e.name},(function(o){e.isVisiblePopover=!1,t.loading=!1,t.getData()}),(function(){t.loading=!1}))},removeConfigMatchs:function(e){var t=this.ruleConfigMatchs.indexOf(e);t>0&&this.ruleConfigMatchs.splice(t,1)},addConfigMatchs:function(){this.ruleConfigMatchs.push({key:"",value:"",type:"set_value"})}}};o("db64");C.render=w;t["default"]=C},"4de4":function(e,t,o){"use strict";var r=o("23e7"),i=o("b727").filter,n=o("1dde"),a=n("filter");r({target:"Array",proto:!0,forced:!a},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},"5a34":function(e,t,o){var r=o("44e7");e.exports=function(e){if(r(e))throw TypeError("The method doesn't accept regular expressions");return e}},8418:function(e,t,o){"use strict";var r=o("a04b"),i=o("9bf2"),n=o("5c6c");e.exports=function(e,t,o){var a=r(t);a in e?i.f(e,a,n(0,o)):e[a]=o}},"9dcc":function(e,t,o){},a15b:function(e,t,o){"use strict";var r=o("23e7"),i=o("44ad"),n=o("fc6a"),a=o("a640"),c=[].join,l=i!=Object,d=a("join",",");r({target:"Array",proto:!0,forced:l||!d},{join:function(e){return c.call(n(this),void 0===e?",":e)}})},a434:function(e,t,o){"use strict";var r=o("23e7"),i=o("23cb"),n=o("a691"),a=o("50c4"),c=o("7b0b"),l=o("65f0"),d=o("8418"),u=o("1dde"),s=u("splice"),f=Math.max,b=Math.min,p=9007199254740991,m="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!s},{splice:function(e,t){var o,r,u,s,h,j,O=c(this),_=a(O.length),V=i(e,_),g=arguments.length;if(0===g?o=r=0:1===g?(o=0,r=_-V):(o=g-2,r=b(f(n(t),0),_-V)),_+o-r>p)throw TypeError(m);for(u=l(O,r),s=0;s<r;s++)h=V+s,h in O&&d(u,s,O[h]);if(u.length=r,o<r){for(s=V;s<_-r;s++)h=s+r,j=s+o,h in O?O[j]=O[h]:delete O[j];for(s=_;s>_-r+o;s--)delete O[s-1]}else if(o>r)for(s=_-r;s>V;s--)h=s+r-1,j=s+o-1,h in O?O[j]=O[h]:delete O[j];for(s=0;s<o;s++)O[s+V]=arguments[s+2];return O.length=_-r+o,u}})},ab13:function(e,t,o){var r=o("b622"),i=r("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(o){try{return t[i]=!1,"/./"[e](t)}catch(r){}}return!1}},caad:function(e,t,o){"use strict";var r=o("23e7"),i=o("4d64").includes,n=o("44d2");r({target:"Array",proto:!0},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n("includes")},db64:function(e,t,o){"use strict";o("9dcc")}}]);
//# sourceMappingURL=chunk-48fb4a10.d0211573.js.map