{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.array.find.js","webpack:///./src/components/report-raw-log.vue","webpack:///./src/components/report-raw-log.vue?ce6d","webpack:///./src/components/report-raw-log.vue?3dcf"],"names":["$","$find","find","addToUnscopables","FIND","SKIPS_HOLES","Array","target","proto","forced","callbackfn","this","arguments","length","undefined","class","span","type","justify","placeholder","prefix-icon","dataSearch","timeZone","onChangeTime","timeList","item","key","label","value","pickerTime","range-separator","start-placeholder","end-placeholder","onClickSearch","data","tableData","style","prop","loadingPage","mixins","dialogNameListItemFormVisible","loading","dataFromTime","dataToTime","mounted","getData","methods","t","response","logSource","message","log_source","$message","duration","showClose","dangerouslyUseHTMLString","oData","postUrl","getTime","onChangePicker","from_time","to_time","sql_query","_data","Results","i","logJson","JSON","parse","LogJson","push","obj","now","Date","select","render"],"mappings":"2IACA,IAAIA,EAAI,EAAQ,QACZC,EAAQ,EAAQ,QAAgCC,KAChDC,EAAmB,EAAQ,QAE3BC,EAAO,OACPC,GAAc,EAGdD,IAAQ,IAAIE,MAAM,GAAGF,IAAM,WAAcC,GAAc,KAI3DL,EAAE,CAAEO,OAAQ,QAASC,OAAO,EAAMC,OAAQJ,GAAe,CACvDH,KAAM,SAAcQ,GAClB,OAAOT,EAAMU,KAAMD,EAAYE,UAAUC,OAAS,EAAID,UAAU,QAAKE,MAKzEX,EAAiBC,I,2DCbH,yBAAkB,UAAd,aAAS,G,EAQrB,yBAA6B,OAAxBW,MAAM,aAAW,S,GAGbA,MAAM,uB,GAINA,MAAM,qB,GAeNA,MAAM,qB,+BASwC,M,GAIlDA,MAAM,c,ohBAjDf,yBA+DS,GA/DuCA,MAAM,kBAAgB,C,8BACpE,iBA6DS,CA7DT,yBA6DS,GA7DAC,KAAM,IAAE,C,8BACf,iBAWS,CAXT,yBAWS,GAXDC,KAAK,OAAOF,MAAM,SAASG,QAAQ,iB,+BACzC,iBASS,CATT,yBASS,GATAF,KAAM,IAAE,C,8BACf,iBAOS,CAPT,yBAOS,GAPDC,KAAK,OAAOF,MAAM,SAASG,QAAQ,iB,+BACzC,iBAES,CAFT,yBAES,GAFAF,KAAM,IAAE,C,8BACf,iBAAkB,CAAlB,M,MAEF,yBAES,GAFAA,KAAM,GAAID,MAAM,yB,0BAM/B,EACA,yBAiCS,Q,8BAhCP,iBA8BS,CA9BT,yBA8BS,GA9BAC,KAAM,IAAE,C,8BACf,iBAGM,CAHN,yBAGM,MAHN,EAGM,CAFJ,yBACW,GADDG,YAAY,UAAUC,cAAY,iB,WAA0B,EAAAC,W,qDAAA,EAAAA,WAAU,K,qDAGlF,yBAcM,MAdN,EAcM,CAbJ,yBAYY,G,WAXD,EAAAC,S,qDAAA,EAAAA,SAAQ,IACjBH,YAAY,MACX,SAAQ,EAAAI,c,+BAGP,iBAAwB,E,2BAD1B,yBAMY,2CALK,EAAAC,UAAQ,SAAhBC,G,gCADT,yBAMY,GAJTC,IAAKD,EAAKC,IACVC,MAAOF,EAAKG,MACZA,MAAOH,EAAKC,K,4FAV4B,WAAR,EAAAJ,Y,4BAevC,yBAQM,MARN,EAQM,CAPJ,yBAME,G,WALS,EAAAO,W,qDAAA,EAAAA,WAAU,IACnBZ,KAAK,gBACLa,kBAAgB,KAChBC,oBAAkB,OAClBC,kBAAgB,Q,0CAN4B,WAAR,EAAAV,YASxC,yBAAiE,GAAtDL,KAAK,UAAW,QAAK,+BAAE,EAAAgB,mB,+BAAiB,iBAAE,C,gCAIzD,yBAYM,MAZN,EAYM,CAXJ,yBASW,GATAC,KAAM,EAAAC,UAAWC,MAAA,gB,+BAC1B,iBAAkE,CAAlE,yBAAkE,GAAjDC,KAAK,aAAaV,MAAM,SACzC,yBAAoE,GAAnDU,KAAK,eAAeV,MAAM,SAC3C,yBAA6D,GAA5CU,KAAK,SAASV,MAAM,QACrC,yBAA0D,GAAzCU,KAAK,OAAOV,MAAM,OACnC,yBAA2D,GAA1CU,KAAK,MAAMV,MAAM,SAClC,yBAAkE,GAAjDU,KAAK,aAAaV,MAAM,SACzC,yBAAiE,GAAhDU,KAAK,YAAYV,MAAM,SACxC,yBAAkE,GAAjDU,KAAK,aAAaV,MAAM,a,gDA1Dd,EAAAW,iB,eAA3B,E,MAAA,M,0BAoEK,GACbC,OAAQ,CAAC,QACTL,KAFa,WAGX,MAAO,CACLI,aAAa,EACbE,+BAA+B,EAC/BC,SAAS,EACTN,UAAW,GACXd,WAAY,GACZqB,aAAc,GACdC,WAAW,GACXrB,SAAU,OACVO,WAAY,GACZL,SAAU,CACR,CAAEE,IAAK,OAAQE,MAAO,MACtB,CAAEF,IAAK,SAAUE,MAAM,QACvB,CAAEF,IAAK,QAASE,MAAO,OACvB,CAAEF,IAAK,UAAWE,MAAO,UAK/BgB,QAtBa,WAuBXjC,KAAKkC,WAEPC,QAAS,CACPD,QADO,WAEL,IAAIE,EAAIpC,KACR,eACE,MACA,+BACA,IACA,SAAUqC,GACRD,EAAEE,UAAYD,EAASd,KAAKgB,QAAQC,WACjB,IAAfJ,EAAEE,UACJF,EAAEK,SAAS,CACTC,SAAU,EACVC,WAAW,EACXJ,QAAS,iFACTjC,KAAM,UACNsC,0BAA0B,IAG5BR,EAAET,aAAc,KAGpB,WACES,EAAET,aAAc,MAItBL,cA1BO,WA2BL,IAAIc,EAAIpC,KACJ6C,EAAQ,GACRC,EAAU,0BACK,OAAfV,EAAEE,YACJQ,EAAU,2BAGRV,EAAE1B,YACJ0B,EAAEW,UACFX,EAAEY,iBACFH,EAAQ,CACNI,UAAWb,EAAEL,aACbmB,QAASd,EAAEJ,WACXmB,UAAWf,EAAE1B,YAEf,eACE,OACAoC,EACAD,GACA,SAAUR,GAER,GADAD,EAAET,aAAc,EACG,OAAfS,EAAEE,UAEJ,IADA,IAAIc,EAAQf,EAASd,KAAKgB,QAAQc,QACzBC,EAAI,EAAGA,EAAIF,EAAMlD,OAAQoD,IAAK,CACrC,IAAIC,EAAUC,KAAKC,MAAML,EAAME,GAAGI,SAClCtB,EAAEZ,UAAUmC,KAAKJ,QAGnBnB,EAAEZ,UAAYa,EAASd,KAAKgB,WAIhC,WACEH,EAAET,aAAc,IAElB,eAGFS,EAAEK,SAAS,CACTE,WAAW,EACXJ,QAAS,UACTjC,KAAM,WAIZM,aAxEO,SAwEMK,GACX,IAAI2C,EAAM,GACVA,EAAM5D,KAAKa,SAAStB,MAAK,SAACuB,GACxB,OAAOA,EAAKC,MAAQE,KAEtBjB,KAAKW,SAAWiD,EAAI7C,KAGtBgC,QAhFO,WAiFL,IAAIc,EAAMC,KAAKL,MAAM,IAAIK,MAAU,IAC/BC,EAAS,GACQ,QAAjB/D,KAAKW,SACPoD,EAAS,OACiB,OAAjB/D,KAAKW,SACdoD,EAAS,MACiB,MAAjB/D,KAAKW,WACdoD,EAAS,MAEX/D,KAAK+B,aAAe8B,EAAME,EAC1B/D,KAAKgC,WAAa6B,GAEpBb,eA7FO,WA8FDhD,KAAKkB,WAAWhB,OAAS,IAC3BF,KAAK+B,aAAe/B,KAAKkB,WAAW,GAAG6B,UAAY,IACnD/C,KAAKgC,WAAahC,KAAKkB,WAAW,GAAG6B,UAAY,Q,UCzLzD,EAAOiB,OAASA,EAED,gB,kCCPf","file":"static/index/js/chunk-dacfc94e.js","sourcesContent":["'use strict';\nvar $ = require('../internals/export');\nvar $find = require('../internals/array-iteration').find;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.es/ecma262/#sec-array.prototype.find\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);\n","<template>\r\n  <el-row v-loading.fullscreen.lock=\"loadingPage\" class=\"report-raw-log\">\r\n    <el-col :span=\"24\">\r\n      <el-row type=\"flex\" class=\"row-bg\" justify=\"space-between\">\r\n        <el-col :span=\"24\">\r\n          <el-row type=\"flex\" class=\"row-bg\" justify=\"space-between\">\r\n            <el-col :span=\"12\">\r\n              <h3>WAF日志查询分析</h3>\r\n            </el-col>\r\n            <el-col :span=\"12\" class=\"text-align-right\">\r\n\r\n            </el-col>\r\n          </el-row>\r\n        </el-col>\r\n      </el-row>\r\n      <div class=\"margin-4x\"></div>\r\n      <el-row>\r\n        <el-col :span=\"24\">\r\n          <div class=\"domain-search-input\">\r\n            <el-input placeholder=\"请输入查询语句\" prefix-icon=\"el-icon-search\" v-model=\"dataSearch\">\r\n            </el-input>\r\n          </div>\r\n          <div class=\"time-select-input\" v-show=\"timeZone!='default'\">\r\n            <el-select\r\n              v-model=\"timeZone\"\r\n              placeholder=\"请选择\"\r\n              @change=\"onChangeTime\"\r\n            >\r\n              <el-option\r\n                v-for=\"item in timeList\"\r\n                :key=\"item.key\"\r\n                :label=\"item.value\"\r\n                :value=\"item.key\"\r\n              >\r\n              </el-option>\r\n            </el-select>\r\n          </div>\r\n          <div class=\"time-select-input\"  v-show=\"timeZone =='default'\">\r\n            <el-date-picker\r\n              v-model=\"pickerTime\"\r\n              type=\"datetimerange\"\r\n              range-separator=\"To\"\r\n              start-placeholder=\"开始时间\"\r\n              end-placeholder=\"结束时间\"\r\n            />\r\n          </div>\r\n          <el-button type=\"primary\" @click=\"onClickSearch()\">查询</el-button>\r\n        </el-col>   \r\n       \r\n      </el-row>\r\n      <div class=\"demo-block\">\r\n        <el-table :data=\"tableData\" style=\" width: 100%\">\r\n          <el-table-column prop=\"request_id\" label=\"请求ID\"></el-table-column>\r\n          <el-table-column prop=\"request_time\" label=\"请求时间\"></el-table-column>\r\n          <el-table-column prop=\"src_ip\" label=\"源IP\"></el-table-column>\r\n          <el-table-column prop=\"host\" label=\"域名\"></el-table-column>\r\n          <el-table-column prop=\"uri\" label=\"访问路径\"></el-table-column>\r\n          <el-table-column prop=\"waf_module\" label=\"防护模块\"></el-table-column>\r\n          <el-table-column prop=\"waf_extra\" label=\"防护策略\"></el-table-column>\r\n          <el-table-column prop=\"waf_action\" label=\"执行动作\"></el-table-column>\r\n        </el-table>\r\n        \r\n      </div>\r\n    </el-col>\r\n  </el-row>\r\n</template>\r\n<script>\r\nimport { mixin, JXAjax } from \"../assets/scripts/common\";\r\n\r\nexport default {\r\n  mixins: [mixin],\r\n  data() {\r\n    return {\r\n      loadingPage: true,\r\n      dialogNameListItemFormVisible: false,\r\n      loading: false,\r\n      tableData: [],\r\n      dataSearch: \"\",\r\n      dataFromTime: \"\",\r\n      dataToTime:\"\",\r\n      timeZone: \"7day\",\r\n      pickerTime: [],\r\n      timeList: [\r\n        { key: \"7day\", value: \"7天\" },\r\n        { key: \"24hour\", value:\"24小时\"  },\r\n        { key: \"1hour\", value: \"1小时\" },\r\n        { key: \"default\", value: \"自定义\" },\r\n      ],\r\n    };\r\n  },\r\n  \r\n  mounted() {\r\n    this.getData();\r\n  },\r\n  methods: {\r\n    getData() {\r\n      var t = this;\r\n      JXAjax(\r\n        \"get\",\r\n        \"/waf/waf_get_sys_report_conf\",\r\n        {},\r\n        function (response) {\r\n          t.logSource = response.data.message.log_source;\r\n          if (t.logSource == \"\") {\r\n            t.$message({\r\n              duration: 0,\r\n              showClose: true,\r\n              message: \"报表配置未设置日志数据来源，\" + \"<a href='/#/sys-report-conf' class='error-message-btn'>\" + \"请前往配置\" + \"</a>\",\r\n              type: \"warning\",\r\n              dangerouslyUseHTMLString: true,\r\n            });\r\n          } else { \r\n            t.loadingPage = false;\r\n          }\r\n        },\r\n        function () {\r\n          t.loadingPage = false;\r\n        }\r\n      );\r\n    },\r\n    onClickSearch() { \r\n      var t = this;\r\n      var oData = {};\r\n      var postUrl = \"/report/cls_get_raw_log\";\r\n      if (t.logSource == \"sls\") { \r\n        postUrl = \"/report/sls_get_raw_log\";\r\n      }\r\n      \r\n      if (t.dataSearch) {\r\n        t.getTime();\r\n        t.onChangePicker();\r\n        oData = {\r\n          from_time: t.dataFromTime,\r\n          to_time: t.dataToTime,\r\n          sql_query: t.dataSearch\r\n        }\r\n        JXAjax(\r\n          \"post\",\r\n          postUrl,\r\n          oData,\r\n          function (response) {\r\n            t.loadingPage = false;\r\n            if (t.logSource == \"cls\") {\r\n              var _data = response.data.message.Results\r\n              for (var i = 0; i < _data.length; i++) {\r\n                var logJson = JSON.parse(_data[i].LogJson)\r\n                t.tableData.push(logJson);\r\n              }\r\n            } else { \r\n              t.tableData = response.data.message\r\n            }\r\n\r\n          },\r\n          function () {\r\n            t.loadingPage = false;\r\n          },\r\n          \"no-message\"\r\n        );\r\n      } else { \r\n        t.$message({\r\n          showClose: true,\r\n          message: '请输入查询语句',\r\n          type: \"error\",\r\n        });\r\n      } \r\n    },\r\n    onChangeTime(value) {\r\n      var obj = {};\r\n      obj = this.timeList.find((item) => {\r\n        return item.key === value;\r\n      });\r\n      this.timeZone = obj.key;\r\n      \r\n    },\r\n    getTime() { \r\n      var now = Date.parse(new Date()) / 1000\r\n      var select = \"\";\r\n      if (this.timeZone == \"7day\") {\r\n        select = 7 * 24 * 60 * 60\r\n      } else if (this.timeZone == \"24h\") {\r\n        select = 24 * 60 * 60\r\n      } else if (this.timeZone == \"1h\") {\r\n        select = 60 * 60\r\n      }\r\n      this.dataFromTime = now - select;\r\n      this.dataToTime = now;\r\n    },\r\n    onChangePicker() { \r\n      if (this.pickerTime.length > 0) { \r\n        this.dataFromTime = this.pickerTime[0].getTime() / 1000;\r\n        this.dataToTime = this.pickerTime[1].getTime() / 1000;\r\n      }\r\n      \r\n    }\r\n  },\r\n};\r\n</script>\r\n<style>\r\n.el-button.button-block {\r\n  display: block;\r\n  margin-left: 0px;\r\n  text-align: right;\r\n  width: 100%;\r\n}\r\n.icon-success {\r\n  color: #67c23a;\r\n  margin-right: 5px;\r\n}\r\n.icon-error {\r\n  color: #f56c6c;\r\n  margin-right: 5px;\r\n}\r\n.icon-warning {\r\n  color: #e6a23c;\r\n  margin-right: 5px;\r\n}\r\n.domain-setting {\r\n  float: right;\r\n}\r\n.domain-redirect {\r\n  margin-top: 5px;\r\n  margin-bottom: 0px !important;\r\n}\r\n\r\n.el-form-item.is-required .redirect-box .el-form-item__label:before {\r\n  content: \"\";\r\n}\r\n.domain-search-input {\r\n  display: block;\r\n  float: left;\r\n  text-align: left;\r\n}\r\n.domain-search-input .el-input {\r\n  width: 100%;\r\n}\r\n.no-padding {\r\n  padding: 0;\r\n}\r\n.node-detail span {\r\n  font-size: 12px;\r\n}\r\n.domain-tabs {\r\n  margin-bottom: 18px;\r\n}\r\n.report-raw-log .time-select-input {\r\n  display: inline-block;\r\n}\r\n.report-raw-log .domain-search-input{\r\n    width: 100%;\r\n    display: inline-block;\r\n    max-width: 600px;\r\n}\r\n</style>\r\n","import { render } from \"./report-raw-log.vue?vue&type=template&id=03071cf3\"\nimport script from \"./report-raw-log.vue?vue&type=script&lang=js\"\nexport * from \"./report-raw-log.vue?vue&type=script&lang=js\"\n\nimport \"./report-raw-log.vue?vue&type=style&index=0&lang=css\"\nscript.render = render\n\nexport default script","export { default } from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./report-raw-log.vue?vue&type=style&index=0&lang=css\"; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./report-raw-log.vue?vue&type=style&index=0&lang=css\""],"sourceRoot":""}