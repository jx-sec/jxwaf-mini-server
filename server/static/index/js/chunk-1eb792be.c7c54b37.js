(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1eb792be"],{"4be3":function(e,t,a){"use strict";a.r(t);var l=a("7a23");const c={class:"custom-edit-wrap"},o=Object(l["createVNode"])("h3",null,"名单",-1),s=Object(l["createVNode"])("a",{class:"el-button el-button--primary is-plain",href:"/#/sys-name-list"},"返回",-1),r=Object(l["createVNode"])("div",{class:"margin-4x"},null,-1),i=Object(l["createTextVNode"])("无限制"),n=Object(l["createTextVNode"])("自定义"),u=Object(l["createTextVNode"])("无限制"),m=Object(l["createTextVNode"])("自定义"),d={class:"match-box-content"},_={class:"match_key_cascader"},b={class:"match_key_input"},p=Object(l["createTextVNode"])("删除"),h=Object(l["createTextVNode"])("新增"),j=Object(l["createVNode"])("p",{class:"form-info-color"}," 说明：标准模式无需人机交互 ",-1),O=Object(l["createVNode"])("div",{class:"margin-4x"},null,-1),g=Object(l["createVNode"])("a",{class:"el-button el-button--primary is-plain",href:"/#/sys-name-list"},"返回",-1),f=Object(l["createTextVNode"])("保存 ");function v(e,t,a,v,y,k){const V=Object(l["resolveComponent"])("el-col"),N=Object(l["resolveComponent"])("el-row"),w=Object(l["resolveComponent"])("el-input"),x=Object(l["resolveComponent"])("el-form-item"),C=Object(l["resolveComponent"])("el-radio"),B=Object(l["resolveComponent"])("el-cascader"),F=Object(l["resolveComponent"])("el-button"),L=Object(l["resolveComponent"])("el-option"),M=Object(l["resolveComponent"])("el-select"),S=Object(l["resolveComponent"])("el-card"),U=Object(l["resolveComponent"])("el-form"),q=Object(l["resolveDirective"])("loading");return Object(l["openBlock"])(),Object(l["createBlock"])("div",c,[Object(l["createVNode"])(N,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(V,{span:24},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(N,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(V,{span:12},{default:Object(l["withCtx"])(()=>[o]),_:1}),Object(l["createVNode"])(V,{span:12,class:"text-align-right"},{default:Object(l["withCtx"])(()=>[s]),_:1})]),_:1})]),_:1})]),_:1}),r,Object(l["withDirectives"])(Object(l["createVNode"])(N,null,{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(V,{span:24},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(U,{class:"custom-edit-form name-and-dict",model:y.sysNameListForm,rules:k.rules,ref:"sysNameListForm","label-width":"180px"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(S,{class:"box-card"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])("div",null,[Object(l["createVNode"])(x,{label:"名单名称",prop:"name_list_name"},{default:Object(l["withCtx"])(()=>["new"==y.type?(Object(l["openBlock"])(),Object(l["createBlock"])(w,{key:0,modelValue:y.sysNameListForm.name_list_name,"onUpdate:modelValue":t[1]||(t[1]=e=>y.sysNameListForm.name_list_name=e),placeholder:"请输入字母开头，字母或数字组合，仅支持_-两种符号"},null,8,["modelValue"])):(Object(l["openBlock"])(),Object(l["createBlock"])(w,{key:1,modelValue:y.sysNameListForm.name_list_name,"onUpdate:modelValue":t[2]||(t[2]=e=>y.sysNameListForm.name_list_name=e),disabled:""},null,8,["modelValue"]))]),_:1}),Object(l["createVNode"])(x,{label:"名单描述"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(w,{modelValue:y.sysNameListForm.name_list_detail,"onUpdate:modelValue":t[3]||(t[3]=e=>y.sysNameListForm.name_list_detail=e)},null,8,["modelValue"])]),_:1}),Object(l["createVNode"])(x,{label:"数量上限",prop:"name_list_limit"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(C,{modelValue:y.limit,"onUpdate:modelValue":t[4]||(t[4]=e=>y.limit=e),label:"0"},{default:Object(l["withCtx"])(()=>[i]),_:1},8,["modelValue"]),Object(l["createVNode"])(C,{modelValue:y.limit,"onUpdate:modelValue":t[5]||(t[5]=e=>y.limit=e),label:"1"},{default:Object(l["withCtx"])(()=>[n]),_:1},8,["modelValue"]),"1"==y.limit?(Object(l["openBlock"])(),Object(l["createBlock"])(w,{key:0,modelValue:y.sysNameListForm.name_list_limit,"onUpdate:modelValue":t[6]||(t[6]=e=>y.sysNameListForm.name_list_limit=e),placeholder:"请输入大于0的数字"},null,8,["modelValue"])):Object(l["createCommentVNode"])("",!0)]),_:1}),Object(l["createVNode"])(x,{label:"过期时间（秒）",prop:"name_list_expire_time"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(C,{modelValue:y.expire_time,"onUpdate:modelValue":t[7]||(t[7]=e=>y.expire_time=e),label:"0"},{default:Object(l["withCtx"])(()=>[u]),_:1},8,["modelValue"]),Object(l["createVNode"])(C,{modelValue:y.expire_time,"onUpdate:modelValue":t[8]||(t[8]=e=>y.expire_time=e),label:"1"},{default:Object(l["withCtx"])(()=>[m]),_:1},8,["modelValue"]),"1"==y.expire_time?(Object(l["openBlock"])(),Object(l["createBlock"])(w,{key:0,modelValue:y.sysNameListForm.name_list_expire_time,"onUpdate:modelValue":t[9]||(t[9]=e=>y.sysNameListForm.name_list_expire_time=e),placeholder:"请输入大于0的数字"},null,8,["modelValue"])):Object(l["createCommentVNode"])("",!0)]),_:1}),Object(l["createVNode"])(x,{label:"匹配参数"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createBlock"])(l["Fragment"],null,Object(l["renderList"])(y.ruleSmallMatchs,(t,a)=>(Object(l["openBlock"])(),Object(l["createBlock"])("div",{class:"match-box",key:a},[Object(l["createVNode"])("div",d,[Object(l["createVNode"])("div",_,[Object(l["createVNode"])(B,{separator:":",modelValue:t.rule_match_key_list,"onUpdate:modelValue":e=>t.rule_match_key_list=e,options:y.optionsMatchKey,props:y.propsMatchKey,onChange:a=>k.onChangeRuleMatchs(a,t,e.bigIndex),clearable:""},null,8,["modelValue","onUpdate:modelValue","options","props","onChange"])]),Object(l["withDirectives"])(Object(l["createVNode"])("div",b,[Object(l["createVNode"])(w,{modelValue:t.rule_match_key,"onUpdate:modelValue":e=>t.rule_match_key=e,clearable:"",onChange:a=>k.onChangeRuleInput(a,t,e.bigIndex)},null,8,["modelValue","onUpdate:modelValue","onChange"])],512),[[l["vShow"],t.showInput]])]),Object(l["createVNode"])(F,{onClick:Object(l["withModifiers"])(a=>k.removeRuleMatchs(t,e.bigIndex),["prevent"])},{default:Object(l["withCtx"])(()=>[p]),_:2},1032,["onClick"])]))),128)),Object(l["createVNode"])(F,{onClick:t[10]||(t[10]=t=>k.addRuleMatchs(e.bigIndex)),plain:"",type:"primary",class:"button-new"},{default:Object(l["withCtx"])(()=>[h]),_:1})]),_:1}),Object(l["createVNode"])(x,{label:"执行动作",prop:"name_list_action"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(M,{modelValue:y.sysNameListForm.name_list_action,"onUpdate:modelValue":t[11]||(t[11]=e=>y.sysNameListForm.name_list_action=e),placeholder:"请选择",onChange:t[12]||(t[12]=e=>k.onChangeRuleAction())},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createBlock"])(l["Fragment"],null,Object(l["renderList"])(y.ruleAction,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(L,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),"check_bypass"==y.sysNameListForm.name_list_action?(Object(l["openBlock"])(),Object(l["createBlock"])(x,{key:0},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(M,{modelValue:y.action_value,"onUpdate:modelValue":t[13]||(t[13]=e=>y.action_value=e),placeholder:"请选择"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createBlock"])(l["Fragment"],null,Object(l["renderList"])(y.optionsCheckBypass,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(L,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):Object(l["createCommentVNode"])("",!0),"bot_check"==y.sysNameListForm.name_list_action?(Object(l["openBlock"])(),Object(l["createBlock"])(x,{key:1},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(M,{modelValue:y.action_value,"onUpdate:modelValue":t[14]||(t[14]=e=>y.action_value=e),placeholder:"请选择"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createBlock"])(l["Fragment"],null,Object(l["renderList"])(y.optionsBotCheck,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(L,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),j]),_:1})):Object(l["createCommentVNode"])("",!0),"custom_response"==y.sysNameListForm.name_list_action?(Object(l["openBlock"])(),Object(l["createBlock"])(x,{key:2},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(M,{modelValue:y.action_value,"onUpdate:modelValue":t[15]||(t[15]=e=>y.action_value=e),placeholder:"请选择"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createBlock"])(l["Fragment"],null,Object(l["renderList"])(y.custom_response,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(L,{key:e.name,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):Object(l["createCommentVNode"])("",!0),"request_replace"==y.sysNameListForm.name_list_action?(Object(l["openBlock"])(),Object(l["createBlock"])(x,{key:3},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(M,{modelValue:y.action_value,"onUpdate:modelValue":t[16]||(t[16]=e=>y.action_value=e),placeholder:"请选择"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createBlock"])(l["Fragment"],null,Object(l["renderList"])(y.request_replace,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(L,{key:e.name,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):Object(l["createCommentVNode"])("",!0),"response_replace"==y.sysNameListForm.name_list_action?(Object(l["openBlock"])(),Object(l["createBlock"])(x,{key:4},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(M,{modelValue:y.action_value,"onUpdate:modelValue":t[17]||(t[17]=e=>y.action_value=e),placeholder:"请选择"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createBlock"])(l["Fragment"],null,Object(l["renderList"])(y.response_replace,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(L,{key:e.name,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):Object(l["createCommentVNode"])("",!0),"traffic_forward"==y.sysNameListForm.name_list_action?(Object(l["openBlock"])(),Object(l["createBlock"])(x,{key:5},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(M,{modelValue:y.action_value,"onUpdate:modelValue":t[18]||(t[18]=e=>y.action_value=e),placeholder:"请选择"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createBlock"])(l["Fragment"],null,Object(l["renderList"])(y.traffic_forward,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(L,{key:e.name,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):Object(l["createCommentVNode"])("",!0),Object(l["createVNode"])(x,{label:"重复写入抑制（秒）",prop:"repeated_writing_suppression"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(w,{modelValue:y.sysNameListForm.repeated_writing_suppression,"onUpdate:modelValue":t[19]||(t[19]=e=>y.sysNameListForm.repeated_writing_suppression=e),placeholder:"请输入大于0的数字"},null,8,["modelValue"])]),_:1})])]),_:1})]),_:1},8,["model","rules"]),O,Object(l["createVNode"])(N,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(V,{span:24},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(N,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(V,{span:12},{default:Object(l["withCtx"])(()=>[g]),_:1}),Object(l["createVNode"])(V,{span:12,class:"text-align-right"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(F,{type:"primary",onClick:t[20]||(t[20]=e=>k.onClickWebRuleProSubmit("sysNameListForm")),loading:y.loading},{default:Object(l["withCtx"])(()=>[f]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512),[[q,y.loadingPage,void 0,{fullscreen:!0,lock:!0}]])])}var y=a("362c"),k=a("6c02"),V={mixins:[y["b"]],data(){return{loading:!1,loadingPage:!1,uuid:"",limit:"0",expire_time:"0",sysNameListForm:{name_list_detail:"",action_value:""},type:"edit",optionsMatchKey:[{value:"http_args",label:"http_args",children:[{value:"path",label:"path"},{value:"query_string",label:"query_string"},{value:"method",label:"method"},{value:"src_ip",label:"src_ip"},{value:"raw_body",label:"raw_body"},{value:"version",label:"version"},{value:"scheme",label:"scheme"},{value:"raw_header",label:"raw_header"}]},{value:"header_args",label:"header_args",children:[{value:"host",label:"host"},{value:"cookie",label:"cookie"},{value:"referer",label:"referer"},{value:"user_agent",label:"user_agent"},{value:"default",label:"自定义"}]},{value:"cookie_args",label:"cookie_args",children:[{value:"default",label:"自定义"}]},{value:"uri_args",label:"uri_args",children:[{value:"default",label:"自定义"}]},{value:"post_args",label:"post_args",children:[{value:"default",label:"自定义"}]},{value:"json_post_args",label:"json_post_args",children:[{value:"default",label:"自定义"}]},{value:"ctx_args",label:"ctx_args",children:[{value:"default",label:"自定义"}]},{value:"shared_dict",label:"shared_dict",children:[{value:"default",label:"自定义"}]},{value:"string",label:"string",children:[{value:"default",label:"自定义"}]}],propsMatchKey:{expandTrigger:"hover"},ruleSmallMatchs:[{rule_match_key_list:[],rule_match_key:"",showInput:!1}],ruleAction:[{value:"block",label:"阻断请求"},{value:"tcp_block",label:"网络层阻断"},{value:"reject_response",label:"拒绝响应"},{value:"watch",label:"观察模式"},{value:"allow",label:"放行请求"},{value:"check_bypass",label:"防护加白"},{value:"bot_check",label:"人机识别"},{value:"custom_response",label:"自定义响应"},{value:"request_replace",label:"请求替换"},{value:"response_replace",label:"响应替换"},{value:"traffic_forward",label:"流量转发"}],optionsCheckBypass:[{value:"web_check_bypassk",label:"基础防护加白"},{value:"flow_check_bypass",label:"流量防护加白"}],optionsBotCheck:[{value:"standard",label:"标准"},{value:"slipper",label:"滑块"},{value:"image",label:"图片验证码"}],custom_response:[],request_replace:[],response_replace:[],traffic_forward:[],action_value:""}},computed:{rules(){return{name_list_name:[{required:!0,message:"请输入规则名称",trigger:["blur","change"]},{validator:y["g"],trigger:["blur","change"]}],name_list_limit:[{required:!0,message:"请输入大于等于0的数字，0代表无限数量",trigger:["blur","change"]},{validator:y["f"],trigger:["blur","change"]}],name_list_expire_time:[{required:!0,message:"请输入大于0的数字",trigger:["blur","change"]},{validator:y["f"],trigger:["blur","change"]}],repeated_writing_suppression:[{required:!0,message:"请输入大于0的数字",trigger:["blur","change"]},{validator:y["f"],trigger:["blur","change"]}],name_list_action:[{required:!0,message:"请选择执行动作",trigger:"change"}]}}},mounted(){var e=this;const t=Object(k["c"])();e.uuid=t.params.uuid,"new"==e.uuid?(e.type="new",e.loadingPage=!1):(e.type="edit",e.loadingPage=!1,e.getData())},methods:{getData(){var e=this,t="/waf/waf_get_sys_name_list",a={name_list_uuid:e.uuid};Object(y["a"])("post",t,a,(function(t){e.loadingPage=!1,e.sysNameListForm=t.data.message;var a=JSON.parse(e.sysNameListForm.name_list_rule),l=[],c=["header_args","cookie_args","uri_args","post_args","json_post_args","string"];for(var o in a){var s=a[o],r=s.key,i=s.value,n="false";c.indexOf(r)>-1&&(n="true"),l.push({rule_match_key_list:[r,i],rule_match_key:r+":"+i,showInput:n})}e.ruleSmallMatchs=l,"custom_response"!=e.sysNameListForm.name_list_action&&"request_replace"!=e.sysNameListForm.name_list_action&&"response_replace"!=e.sysNameListForm.name_list_action&&"traffic_forward"!=e.sysNameListForm.name_list_action||e.onChangeRuleAction(),"100000000"!=e.sysNameListForm.name_list_limit&&(e.limit="1"),"3155760000"!=e.sysNameListForm.name_list_expire_time&&(e.expire_time="1")}),(function(){e.loadingPage=!1}),"no-message")},onClickWebRuleProSubmit(e){var t=this,a=[];if(0==t.ruleSmallMatchs.length)return t.$message({message:"请选择匹配参数",type:"error"}),!1;if(""==t.ruleSmallMatchs[0].rule_match_key)return t.$message({message:"请选择匹配参数",type:"error"}),!1;if("check_bypass"==t.sysNameListForm.name_list_action&&""==t.sysNameListForm.action_value)return t.$message({message:"请选择防护加白类型",type:"error"}),!1;if("bot_check"==t.sysNameListForm.name_list_action&&""==t.sysNameListForm.action_value)return t.$message({message:"请选择人机识别方式",type:"error"}),!1;for(var l in t.ruleSmallMatchs){var c=t.ruleSmallMatchs[l],o="",s=[],r="",i="";c.rule_match_key&&(s=c.rule_match_key.split(":")),s.length>0&&(r=s[0],i=c.rule_match_key.replace(new RegExp(r+":"),""),o='{"key":"'+r+'" , "value":"'+i+'"}'),a.push(JSON.parse(o))}"0"==t.limit&&(t.sysNameListForm.name_list_limit=1e8),"0"==t.expire_time&&(t.sysNameListForm.name_list_expire_time=315576e4);var n="/waf/waf_edit_sys_name_list";"new"==t.type?n="/waf/waf_create_sys_name_list":t.sysNameListForm.name_list_uuid=t.uuid,t.sysNameListForm.name_list_rule=JSON.stringify(a),this.$refs[e].validate(e=>{e&&(t.loading=!0,Object(y["a"])("post",n,t.sysNameListForm,(function(e){t.loading=!1,window.location.href="/#/sys-name-list/"}),(function(){t.loading=!1})))})},removeRuleMatchs(e){var t=this.ruleSmallMatchs.indexOf(e);-1!==t&&this.ruleSmallMatchs.splice(t,1)},addRuleMatchs(){this.ruleSmallMatchs.push({rule_match_key:"",showInput:!1})},onChangeRuleMatchs(e,t,a){var l=this.ruleSmallMatchs.indexOf(t);"default"==e[1]?(this.ruleSmallMatchs[l].showInput=!0,this.ruleSmallMatchs[l].rule_match_key=e[0]+":"):this.ruleSmallMatchs[l].rule_match_key=e[0]+":"+e[1]},onChangeRuleInput(e,t,a){var l=this.ruleSmallMatchs.indexOf(t);""==e?(this.ruleSmallMatchs[l].showInput=!1,this.ruleSmallMatchs[l].rule_match_key="",this.ruleSmallMatchs[l].rule_match_key_list=[]):this.ruleSmallMatchs[l].rule_match_key=e},onChangeRuleAction(){var e=this;e.action_value="";var t={};0==e.custom_response.length&&"custom_response"==e.sysNameListForm.name_list_action&&Object(y["a"])("post","/waf/waf_get_sys_custom_response_list",t,(function(t){e.custom_response=t.data.message}),(function(){}),"no-message"),0==e.request_replace.length&&"request_replace"==e.sysNameListForm.name_list_action&&Object(y["a"])("post","/waf/waf_get_sys_request_replace_list",t,(function(t){e.request_replace=t.data.message}),(function(){}),"no-message"),0==e.response_replace.length&&"response_replace"==e.sysNameListForm.name_list_action&&Object(y["a"])("post","/waf/waf_get_sys_response_replace_list",t,(function(t){e.response_replace=t.data.message}),(function(){}),"no-message"),0==e.traffic_forward.length&&"traffic_forward"==e.sysNameListForm.name_list_action&&Object(y["a"])("post","/waf/waf_get_sys_traffic_forward_list",t,(function(t){e.traffic_forward=t.data.message}),(function(){}),"no-message")}}},N=(a("bf69"),a("d959")),w=a.n(N);const x=w()(V,[["render",v]]);t["default"]=x},"4f9d":function(e,t,a){},bf69:function(e,t,a){"use strict";a("4f9d")}}]);
//# sourceMappingURL=chunk-1eb792be.c7c54b37.js.map