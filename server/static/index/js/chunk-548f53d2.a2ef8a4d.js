(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-548f53d2"],{"2e5b":function(e,t,a){"use strict";a("ce4a")},b36b:function(e,t,a){"use strict";a.r(t);var l=a("7a23");const r={class:"custom-edit-wrap"},c=Object(l["createVNode"])("h3",null,"共享字典配置",-1),s=Object(l["createVNode"])("a",{class:"el-button el-button--primary is-plain",href:"/#/sys-shared-dict/"},"返回",-1),d=Object(l["createVNode"])("div",{class:"margin-4x"},null,-1),o={class:"match-box-content"},i={class:"match_key_cascader"},u={class:"match_key_input"},n=Object(l["createTextVNode"])("删除"),h=Object(l["createTextVNode"])("新增"),b=Object(l["createTextVNode"])("数字"),_=Object(l["createTextVNode"])("字符串"),m={class:"form-info-color"},p={class:"form-info-color"},j=Object(l["createVNode"])("div",{class:"margin-4x"},null,-1),O=Object(l["createVNode"])("a",{class:"el-button el-button--primary is-plain",href:"/#/sys-shared-dict/"},"返回",-1),g=Object(l["createTextVNode"])("保存 ");function y(e,t,a,y,f,v){const w=Object(l["resolveComponent"])("el-col"),V=Object(l["resolveComponent"])("el-row"),x=Object(l["resolveComponent"])("el-input"),S=Object(l["resolveComponent"])("el-form-item"),k=Object(l["resolveComponent"])("el-cascader"),C=Object(l["resolveComponent"])("el-button"),N=Object(l["resolveComponent"])("el-radio"),D=Object(l["resolveComponent"])("el-radio-group"),M=Object(l["resolveComponent"])("el-card"),F=Object(l["resolveComponent"])("el-form"),I=Object(l["resolveDirective"])("loading");return Object(l["openBlock"])(),Object(l["createBlock"])("div",r,[Object(l["createVNode"])(V,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(w,{span:24},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(V,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(w,{span:12},{default:Object(l["withCtx"])(()=>[c]),_:1}),Object(l["createVNode"])(w,{span:12,class:"text-align-right"},{default:Object(l["withCtx"])(()=>[s]),_:1})]),_:1})]),_:1})]),_:1}),d,Object(l["withDirectives"])(Object(l["createVNode"])(V,null,{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(w,{span:24},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(F,{class:"custom-edit-form name-and-dict",model:f.sysSharedDictForm,rules:v.rules,ref:"sysSharedDictForm","label-width":"180px"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(M,{class:"box-card"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])("div",null,[Object(l["createVNode"])(S,{label:"字典名称",prop:"shared_dict_name"},{default:Object(l["withCtx"])(()=>["new"==f.uuid?(Object(l["openBlock"])(),Object(l["createBlock"])(x,{key:0,modelValue:f.sysSharedDictForm.shared_dict_name,"onUpdate:modelValue":t[1]||(t[1]=e=>f.sysSharedDictForm.shared_dict_name=e),placeholder:"请输入字母开头，字母或数字组合，仅支持_-两种符号"},null,8,["modelValue"])):(Object(l["openBlock"])(),Object(l["createBlock"])(x,{key:1,modelValue:f.sysSharedDictForm.shared_dict_name,"onUpdate:modelValue":t[2]||(t[2]=e=>f.sysSharedDictForm.shared_dict_name=e),disabled:""},null,8,["modelValue"]))]),_:1}),Object(l["createVNode"])(S,{label:"字典描述"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(x,{modelValue:f.sysSharedDictForm.shared_dict_detail,"onUpdate:modelValue":t[3]||(t[3]=e=>f.sysSharedDictForm.shared_dict_detail=e)},null,8,["modelValue"])]),_:1}),Object(l["createVNode"])(S,{label:"匹配参数"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createBlock"])(l["Fragment"],null,Object(l["renderList"])(f.ruleSmallMatchs,(t,a)=>(Object(l["openBlock"])(),Object(l["createBlock"])("div",{class:"match-box",key:a},[Object(l["createVNode"])("div",o,[Object(l["createVNode"])("div",i,[Object(l["createVNode"])(k,{separator:":",modelValue:t.rule_match_key_list,"onUpdate:modelValue":e=>t.rule_match_key_list=e,options:f.optionsMatchKey,props:f.propsMatchKey,onChange:a=>v.onChangeRuleMatchs(a,t,e.bigIndex),clearable:""},null,8,["modelValue","onUpdate:modelValue","options","props","onChange"])]),Object(l["withDirectives"])(Object(l["createVNode"])("div",u,[Object(l["createVNode"])(x,{modelValue:t.rule_match_key,"onUpdate:modelValue":e=>t.rule_match_key=e,clearable:"",onChange:a=>v.onChangeRuleInput(a,t,e.bigIndex)},null,8,["modelValue","onUpdate:modelValue","onChange"])],512),[[l["vShow"],t.showInput]])]),Object(l["createVNode"])(C,{onClick:Object(l["withModifiers"])(a=>v.removeRuleMatchs(t,e.bigIndex),["prevent"])},{default:Object(l["withCtx"])(()=>[n]),_:2},1032,["onClick"])]))),128)),Object(l["createVNode"])(C,{onClick:t[4]||(t[4]=t=>v.addRuleMatchs(e.bigIndex)),plain:"",type:"primary",class:"button-new"},{default:Object(l["withCtx"])(()=>[h]),_:1})]),_:1}),Object(l["createVNode"])(S,{label:"字典值类型",prop:"shared_dict_type"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(D,{modelValue:f.sysSharedDictForm.shared_dict_type,"onUpdate:modelValue":t[5]||(t[5]=e=>f.sysSharedDictForm.shared_dict_type=e)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(N,{label:"number"},{default:Object(l["withCtx"])(()=>[b]),_:1}),Object(l["createVNode"])(N,{label:"string"},{default:Object(l["withCtx"])(()=>[_]),_:1})]),_:1},8,["modelValue"]),Object(l["withDirectives"])(Object(l["createVNode"])("p",m," 数字初使值固定为0，每次写入增加1 ",512),[[l["vShow"],"number"==f.sysSharedDictForm.shared_dict_type]]),Object(l["withDirectives"])(Object(l["createVNode"])("p",p," 字符串初使值为字符串 true ",512),[[l["vShow"],"string"==f.sysSharedDictForm.shared_dict_type]])]),_:1}),Object(l["createVNode"])(S,{label:"过期时间（秒）",prop:"shared_dict_expire_time"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(x,{modelValue:f.sysSharedDictForm.shared_dict_expire_time,"onUpdate:modelValue":t[6]||(t[6]=e=>f.sysSharedDictForm.shared_dict_expire_time=e),placeholder:"请输入大于等于0的数字，0代表无限制"},null,8,["modelValue"])]),_:1})])]),_:1})]),_:1},8,["model","rules"]),j,Object(l["createVNode"])(V,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(w,{span:24},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(V,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(w,{span:12},{default:Object(l["withCtx"])(()=>[O]),_:1}),Object(l["createVNode"])(w,{span:12,class:"text-align-right"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(C,{type:"primary",onClick:t[7]||(t[7]=e=>v.onClicksysSharedDictSubmit("sysSharedDictForm")),loading:f.loading},{default:Object(l["withCtx"])(()=>[g]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512),[[I,f.loadingPage,void 0,{fullscreen:!0,lock:!0}]])])}var f=a("362c"),v=a("6c02"),w={mixins:[f["b"]],data(){return{loading:!1,loadingPage:!1,uuid:"new",sysSharedDictForm:{shared_dict_detail:"",shared_dict_type:"number",shared_dict_value:"0"},optionsMatchKey:[{value:"http_args",label:"http_args",children:[{value:"path",label:"path"},{value:"query_string",label:"query_string"},{value:"method",label:"method"},{value:"src_ip",label:"src_ip"},{value:"raw_body",label:"raw_body"},{value:"version",label:"version"},{value:"scheme",label:"scheme"},{value:"raw_header",label:"raw_header"}]},{value:"header_args",label:"header_args",children:[{value:"host",label:"host"},{value:"cookie",label:"cookie"},{value:"referer",label:"referer"},{value:"user_agent",label:"user_agent"},{value:"default",label:"自定义"}]},{value:"cookie_args",label:"cookie_args",children:[{value:"default",label:"自定义"}]},{value:"uri_args",label:"uri_args",children:[{value:"default",label:"自定义"}]},{value:"post_args",label:"post_args",children:[{value:"default",label:"自定义"}]},{value:"json_post_args",label:"json_post_args",children:[{value:"default",label:"自定义"}]}],propsMatchKey:{expandTrigger:"hover"},ruleSmallMatchs:[{rule_match_key_list:[],rule_match_key:"",showInput:!1}]}},computed:{rules(){return{shared_dict_name:[{required:!0,message:"请输入规则名称",trigger:["blur","change"]},{validator:f["g"],trigger:["blur","change"]}],shared_dict_expire_time:[{required:!0,message:"请输入匹配内容",trigger:["blur","change"]}]}}},mounted(){var e=this;const t=Object(v["c"])();e.uuid=t.params.uuid,"new"==e.uuid?e.loadingPage=!1:(e.loadingPage=!1,e.getData())},methods:{getData(){var e=this,t="/waf/waf_get_sys_shared_dict",a={shared_dict_uuid:e.uuid};Object(f["a"])("post",t,a,(function(t){e.loadingPage=!1,e.sysSharedDictForm=t.data.message;var a=JSON.parse(e.sysSharedDictForm.shared_dict_key),l=[],r=["header_args","cookie_args","uri_args","post_args","json_post_args","ctx_args","shared_dict","string"];for(var c in a){var s=a[c],d=s.key,o=s.value,i="false";r.indexOf(d)>-1&&(i="true"),l.push({rule_match_key_list:[d,o],rule_match_key:d+":"+o,showInput:i})}e.ruleSmallMatchs=l}),(function(){e.loadingPage=!1}),"no-message")},onChangeType(){var e=this;"number"==e.sysSharedDictForm.shared_dict_type?e.sysSharedDictForm.shared_dict_value="0":e.sysSharedDictForm.shared_dict_value="true"},onClicksysSharedDictSubmit(e){var t=this,a=[];if(0==t.ruleSmallMatchs.length)return t.$message({message:"请选择匹配参数",type:"error"}),!1;if(""==t.ruleSmallMatchs[0].rule_match_key)return t.$message({message:"请选择匹配参数",type:"error"}),!1;for(var l in t.ruleSmallMatchs){var r=t.ruleSmallMatchs[l],c="",s=[],d="",o="";r.rule_match_key&&(s=r.rule_match_key.split(":")),s.length>0&&(d=s[0],o=r.rule_match_key.replace(new RegExp(d+":"),""),c='{"key":"'+d+'" , "value":"'+o+'"}'),a.push(JSON.parse(c))}var i="/waf/waf_edit_sys_shared_dict";"new"==t.uuid?i="/waf/waf_create_sys_shared_dict":t.sysSharedDictForm.shared_dict_uuid=t.uuid,t.sysSharedDictForm.shared_dict_key=JSON.stringify(a),this.$refs[e].validate(e=>{e&&(t.loading=!0,Object(f["a"])("post",i,t.sysSharedDictForm,(function(e){t.loading=!1,window.location.href="/#/sys-shared-dict/"}),(function(){t.loading=!1})))})},removeRuleMatchs(e){var t=this.ruleSmallMatchs.indexOf(e);-1!=t&&this.ruleSmallMatchs.splice(t,1)},addRuleMatchs(){this.ruleSmallMatchs.push({rule_match_key:"",showInput:!1})},onChangeRuleMatchs(e,t,a){var l=this.ruleSmallMatchs.indexOf(t);"default"==e[1]?(this.ruleSmallMatchs[l].showInput=!0,this.ruleSmallMatchs[l].rule_match_key=e[0]+":"):this.ruleSmallMatchs[l].rule_match_key=e[0]+":"+e[1]},onChangeRuleInput(e,t,a){var l=this.ruleSmallMatchs.indexOf(t);""==e?(this.ruleSmallMatchs[l].showInput=!1,this.ruleSmallMatchs[l].rule_match_key="",this.ruleSmallMatchs[l].rule_match_key_list=[]):this.ruleSmallMatchs[l].rule_match_key=e}}},V=(a("2e5b"),a("d959")),x=a.n(V);const S=x()(w,[["render",y]]);t["default"]=S},ce4a:function(e,t,a){}}]);
//# sourceMappingURL=chunk-548f53d2.a2ef8a4d.js.map