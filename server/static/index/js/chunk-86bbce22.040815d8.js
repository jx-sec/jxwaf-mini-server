(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-86bbce22"],{"33e1":function(e,t,a){},"68f2":function(e,t,a){"use strict";a.r(t);var l=a("7a23");const o={class:"custom-edit-wrap"},c=Object(l["createTextVNode"])("防护管理"),r=Object(l["createTextVNode"])("名单防护"),s=Object(l["createTextVNode"])("新增"),i=Object(l["createTextVNode"])("编辑"),n=Object(l["createTextVNode"])("永久生效"),u=Object(l["createTextVNode"])("自定义"),m={class:"match-box-content"},d={class:"match_key_cascader"},b={class:"match_key_input"},_=Object(l["createTextVNode"])("删除"),h=Object(l["createTextVNode"])("新增"),p=Object(l["createVNode"])("p",{class:"form-info-color"}," 说明：标准模式无需人机交互 ",-1),O=Object(l["createVNode"])("a",{class:"el-button el-button--primary is-plain",href:"/#/name-list"},"返回",-1),j=Object(l["createTextVNode"])("保存 ");function f(e,t,a,f,v,g){const y=Object(l["resolveComponent"])("el-breadcrumb-item"),N=Object(l["resolveComponent"])("el-breadcrumb"),V=Object(l["resolveComponent"])("el-row"),k=Object(l["resolveComponent"])("el-input"),w=Object(l["resolveComponent"])("el-form-item"),x=Object(l["resolveComponent"])("el-radio"),C=Object(l["resolveComponent"])("el-cascader"),L=Object(l["resolveComponent"])("el-button"),M=Object(l["resolveComponent"])("el-option"),F=Object(l["resolveComponent"])("el-select"),S=Object(l["resolveComponent"])("el-form"),B=Object(l["resolveComponent"])("el-col"),R=Object(l["resolveDirective"])("loading");return Object(l["openBlock"])(),Object(l["createBlock"])("div",o,[Object(l["createVNode"])(V,{class:"breadcrumb-style"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(N,{separator:"/"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(y,{to:{path:"/"}},{default:Object(l["withCtx"])(()=>[c]),_:1}),Object(l["createVNode"])(y,{to:{path:"/name-list"}},{default:Object(l["withCtx"])(()=>[r]),_:1}),"new"==v.uuid?(Object(l["openBlock"])(),Object(l["createBlock"])(y,{key:0},{default:Object(l["withCtx"])(()=>[s]),_:1})):(Object(l["openBlock"])(),Object(l["createBlock"])(y,{key:1},{default:Object(l["withCtx"])(()=>[i]),_:1}))]),_:1})]),_:1}),Object(l["createVNode"])(V,{class:"container-style"},{default:Object(l["withCtx"])(()=>[Object(l["withDirectives"])(Object(l["createVNode"])(B,{span:24},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(S,{class:"custom-edit-form name-and-dict",model:v.sysNameListForm,rules:g.rules,ref:"sysNameListForm","label-width":"180px"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])("div",null,[Object(l["createVNode"])(w,{label:"名单名称",prop:"name_list_name"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(k,{modelValue:v.sysNameListForm.name_list_name,"onUpdate:modelValue":t[1]||(t[1]=e=>v.sysNameListForm.name_list_name=e),placeholder:"请输入字母开头，字母或数字组合，仅支持_-两种符号"},null,8,["modelValue"])]),_:1}),Object(l["createVNode"])(w,{label:"名单描述"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(k,{modelValue:v.sysNameListForm.name_list_detail,"onUpdate:modelValue":t[2]||(t[2]=e=>v.sysNameListForm.name_list_detail=e)},null,8,["modelValue"])]),_:1}),Object(l["createVNode"])(w,{label:"过期时间（秒）"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(x,{modelValue:v.sysNameListForm.name_list_expire,"onUpdate:modelValue":t[3]||(t[3]=e=>v.sysNameListForm.name_list_expire=e),label:"false"},{default:Object(l["withCtx"])(()=>[n]),_:1},8,["modelValue"]),Object(l["createVNode"])(x,{modelValue:v.sysNameListForm.name_list_expire,"onUpdate:modelValue":t[4]||(t[4]=e=>v.sysNameListForm.name_list_expire=e),label:"ture"},{default:Object(l["withCtx"])(()=>[u]),_:1},8,["modelValue"])]),_:1}),"ture"==v.sysNameListForm.name_list_expire?(Object(l["openBlock"])(),Object(l["createBlock"])(w,{key:0,prop:"name_list_expire_time"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(k,{modelValue:v.sysNameListForm.name_list_expire_time,"onUpdate:modelValue":t[5]||(t[5]=e=>v.sysNameListForm.name_list_expire_time=e),placeholder:"请输入大于0的数字"},null,8,["modelValue"])]),_:1})):Object(l["createCommentVNode"])("",!0),Object(l["createVNode"])(w,{label:"匹配参数"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createBlock"])(l["Fragment"],null,Object(l["renderList"])(v.ruleSmallMatchs,(t,a)=>(Object(l["openBlock"])(),Object(l["createBlock"])("div",{class:"match-box",key:a},[Object(l["createVNode"])("div",m,[Object(l["createVNode"])("div",d,[Object(l["createVNode"])(C,{separator:":",modelValue:t.rule_match_key_list,"onUpdate:modelValue":e=>t.rule_match_key_list=e,options:v.optionsMatchKey,props:v.propsMatchKey,onChange:a=>g.onChangeRuleMatchs(a,t,e.bigIndex),clearable:""},null,8,["modelValue","onUpdate:modelValue","options","props","onChange"])]),Object(l["withDirectives"])(Object(l["createVNode"])("div",b,[Object(l["createVNode"])(k,{modelValue:t.rule_match_key,"onUpdate:modelValue":e=>t.rule_match_key=e,clearable:"",onChange:a=>g.onChangeRuleInput(a,t,e.bigIndex)},null,8,["modelValue","onUpdate:modelValue","onChange"])],512),[[l["vShow"],t.showInput]])]),Object(l["createVNode"])(L,{onClick:Object(l["withModifiers"])(a=>g.removeRuleMatchs(t,e.bigIndex),["prevent"])},{default:Object(l["withCtx"])(()=>[_]),_:2},1032,["onClick"])]))),128)),Object(l["createVNode"])(L,{onClick:t[6]||(t[6]=t=>g.addRuleMatchs(e.bigIndex)),plain:"",type:"primary",class:"button-new"},{default:Object(l["withCtx"])(()=>[h]),_:1})]),_:1}),Object(l["createVNode"])(w,{label:"执行动作",prop:"name_list_action"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(F,{modelValue:v.sysNameListForm.name_list_action,"onUpdate:modelValue":t[7]||(t[7]=e=>v.sysNameListForm.name_list_action=e),placeholder:"请选择",onChange:t[8]||(t[8]=e=>g.onChangeRuleAction())},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createBlock"])(l["Fragment"],null,Object(l["renderList"])(v.ruleAction,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(M,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),"bot_check"==v.sysNameListForm.name_list_action?(Object(l["openBlock"])(),Object(l["createBlock"])(w,{key:1},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(F,{modelValue:v.sysNameListForm.action_value,"onUpdate:modelValue":t[9]||(t[9]=e=>v.sysNameListForm.action_value=e),placeholder:"请选择"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createBlock"])(l["Fragment"],null,Object(l["renderList"])(v.optionsBotCheck,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(M,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),p]),_:1})):Object(l["createCommentVNode"])("",!0)])]),_:1},8,["model","rules"]),Object(l["createVNode"])(V,{type:"flex",class:"margin-border",justify:"space-between"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(B,{span:12},{default:Object(l["withCtx"])(()=>[O]),_:1}),Object(l["createVNode"])(B,{span:12,class:"text-align-right"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(L,{type:"primary",onClick:t[10]||(t[10]=e=>g.onClickWebRuleProSubmit("sysNameListForm")),loading:v.loading},{default:Object(l["withCtx"])(()=>[j]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512),[[R,v.loadingPage,void 0,{fullscreen:!0,lock:!0}]])]),_:1})])}var v=a("362c"),g=a("6c02"),y={mixins:[v["d"]],data(){return{loading:!1,loadingPage:!1,uuid:"",sysNameListForm:{name_list_name:"",name_list_detail:"",name_list_rule:"",name_list_action:"",name_list_expire:"false",name_list_expire_time:"",action_value:""},type:"edit",optionsMatchKey:[{value:"http_args",label:"http_args",children:[{value:"path",label:"path",leaf:!0},{value:"query_string",label:"query_string",leaf:!0},{value:"method",label:"method",leaf:!0},{value:"src_ip",label:"src_ip",leaf:!0},{value:"raw_body",label:"raw_body",leaf:!0},{value:"version",label:"version",leaf:!0},{value:"scheme",label:"scheme",leaf:!0},{value:"raw_header",label:"raw_header",leaf:!0}]},{value:"header_args",label:"header_args",children:[{value:"host",label:"host",leaf:!0},{value:"cookie",label:"cookie",leaf:!0},{value:"referer",label:"referer",leaf:!0},{value:"user_agent",label:"user_agent",leaf:!0},{value:"default",label:"自定义",leaf:!0}]},{value:"cookie_args",label:"cookie_args",children:[{value:"default",label:"自定义",leaf:!0}]},{value:"uri_args",label:"uri_args",children:[{value:"default",label:"自定义",leaf:!0}]},{value:"post_args",label:"post_args",children:[{value:"default",label:"自定义",leaf:!0}]},{value:"json_post_args",label:"json_post_args",children:[{value:"default",label:"自定义",leaf:!0}]}],propsMatchKey:{expandTrigger:"hover",lazy:!0,lazyLoad(e,t){}},ruleSmallMatchs:[{rule_match_key_list:[],rule_match_key:"",showInput:!1}],ruleAction:[{value:"block",label:"阻断请求"},{value:"reject_response",label:"拒绝响应"},{value:"watch",label:"观察模式"},{value:"bot_check",label:"人机识别"},{value:"all_bypass",label:"安全防护全加白"},{value:"web_bypass",label:"Web安全防护加白"},{value:"flow_bypass",label:"流量安全防护加白"}],optionsBotCheck:[{value:"standard",label:"标准"},{value:"slipper",label:"滑块"},{value:"image",label:"图片验证码"}]}},computed:{rules(){return{name_list_name:[{required:!0,message:"请输入规则名称",trigger:["blur","change"]},{validator:v["j"],trigger:["blur","change"]}],name_list_expire_time:[{required:!0,message:"请输入大于0的数字",trigger:["blur","change"]},{validator:v["i"],trigger:["blur","change"]}],name_list_action:[{required:!0,message:"请选择执行动作",trigger:"change"}]}}},mounted(){var e=this;const t=Object(g["c"])();e.uuid=t.params.uuid,"new"==e.uuid?(e.type="new",e.loadingPage=!1):(e.type="edit",e.loadingPage=!1,e.getData())},methods:{getData(){var e=this,t="/waf/waf_get_name_list",a={name_list_name:e.uuid};Object(v["a"])("post",t,a,(function(t){e.loadingPage=!1,e.sysNameListForm=t.data.message;var a=JSON.parse(e.sysNameListForm.name_list_rule),l=[],o=["query_string","json_post","post","cookie","waf_description","ctx","string"];for(var c in a){var r=a[c],s=r.key,i=r.value,n="false";o.indexOf(s)>-1&&(n="true"),l.push({rule_match_key_list:[s,i],rule_match_key:s+":"+i,showInput:n})}e.ruleSmallMatchs=l}),(function(){e.loadingPage=!1}),"no-message")},onClickWebRuleProSubmit(e){var t=this,a=[];if(0==t.ruleSmallMatchs.length)return t.$message({message:"请选择匹配参数",type:"error"}),!1;if(""==t.ruleSmallMatchs[0].rule_match_key)return t.$message({message:"请选择匹配参数",type:"error"}),!1;for(var l in t.ruleSmallMatchs){var o=t.ruleSmallMatchs[l],c="",r=[],s="",i="";o.rule_match_key&&(r=o.rule_match_key.split(":")),r.length>0&&(s=r[0],i=o.rule_match_key.replace(new RegExp(s+":"),""),c='{"key":"'+s+'" , "value":"'+i+'"}'),a.push(JSON.parse(c))}"false"==t.sysNameListForm.name_list_expire&&(t.sysNameListForm.name_list_expire_time=0);var n="/waf/waf_edit_name_list";"new"==t.type&&(n="/waf/waf_create_name_list"),t.sysNameListForm.name_list_rule=JSON.stringify(a),this.$refs[e].validate(e=>{e&&(t.loading=!0,Object(v["a"])("post",n,t.sysNameListForm,(function(e){t.loading=!1,window.location.href="/#/name-list/"}),(function(){t.loading=!1})))})},onChangeRuleAction(){var e=this;e.action_value=""},removeRuleMatchs(e){var t=this.ruleSmallMatchs.indexOf(e);-1!==t&&this.ruleSmallMatchs.splice(t,1)},addRuleMatchs(){this.ruleSmallMatchs.push({rule_match_key:"",showInput:!1})},onChangeRuleMatchs(e,t,a){if(e&&e.length>0){var l=this.ruleSmallMatchs.indexOf(t);"default"==e[1]?(this.ruleSmallMatchs[l].showInput=!0,this.ruleSmallMatchs[l].rule_match_key=e[0]+":"):this.ruleSmallMatchs[l].rule_match_key=e[0]+":"+e[1]}},onChangeRuleInput(e,t,a){var l=this.ruleSmallMatchs.indexOf(t);""==e?(this.ruleSmallMatchs[l].showInput=!1,this.ruleSmallMatchs[l].rule_match_key="",this.ruleSmallMatchs[l].rule_match_key_list=[]):this.ruleSmallMatchs[l].rule_match_key=e}}},N=(a("8477"),a("d959")),V=a.n(N);const k=V()(y,[["render",f]]);t["default"]=k},8477:function(e,t,a){"use strict";a("33e1")}}]);
//# sourceMappingURL=chunk-86bbce22.040815d8.js.map