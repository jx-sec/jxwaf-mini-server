(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-671e48de"],{"1d3c":function(e,t,c){"use strict";c.r(t);var a=c("7a23");const o={class:"page-owasp-wrap"},l=Object(a["createVNode"])("h3",null,"Web防护引擎配置",-1),b=Object(a["createVNode"])("div",{class:"margin-4x"},null,-1),r=Object(a["createTextVNode"])("阻断请求"),d=Object(a["createTextVNode"])("拒绝响应"),i=Object(a["createTextVNode"])("长亭拟态防御"),n=Object(a["createTextVNode"])("观察"),j=Object(a["createTextVNode"])("关闭"),O=Object(a["createTextVNode"])("阻断请求"),u=Object(a["createTextVNode"])("拒绝响应"),s=Object(a["createTextVNode"])("长亭拟态防御"),m=Object(a["createTextVNode"])("观察"),_=Object(a["createTextVNode"])("关闭"),V=Object(a["createTextVNode"])("阻断请求"),w=Object(a["createTextVNode"])("拒绝响应"),f=Object(a["createTextVNode"])("长亭拟态防御"),h=Object(a["createTextVNode"])("观察"),p=Object(a["createTextVNode"])("关闭"),x=Object(a["createTextVNode"])("阻断请求"),N=Object(a["createTextVNode"])("拒绝响应"),g=Object(a["createTextVNode"])("长亭拟态防御"),C=Object(a["createTextVNode"])("观察"),k=Object(a["createTextVNode"])("关闭"),T=Object(a["createTextVNode"])("阻断请求"),y=Object(a["createTextVNode"])("拒绝响应"),v=Object(a["createTextVNode"])("长亭拟态防御"),B=Object(a["createTextVNode"])("观察"),E=Object(a["createTextVNode"])("关闭"),F=Object(a["createTextVNode"])("阻断请求"),M=Object(a["createTextVNode"])("拒绝响应"),P=Object(a["createTextVNode"])("长亭拟态防御"),U=Object(a["createTextVNode"])("观察"),S=Object(a["createTextVNode"])("关闭"),D=Object(a["createTextVNode"])("阻断请求"),L=Object(a["createTextVNode"])("拒绝响应"),$=Object(a["createTextVNode"])("长亭拟态防御"),q=Object(a["createTextVNode"])("观察"),J=Object(a["createTextVNode"])("关闭"),W=Object(a["createVNode"])("div",{class:"margin-4x"},null,-1),Q=Object(a["createTextVNode"])("保存");function X(e,t,c,X,z,A){const G=Object(a["resolveComponent"])("el-col"),H=Object(a["resolveComponent"])("el-row"),I=Object(a["resolveComponent"])("el-divider"),K=Object(a["resolveComponent"])("el-radio"),R=Object(a["resolveComponent"])("el-radio-group"),Y=Object(a["resolveComponent"])("el-form-item"),Z=Object(a["resolveComponent"])("el-form"),ee=Object(a["resolveComponent"])("el-button"),te=Object(a["resolveDirective"])("loading");return Object(a["openBlock"])(),Object(a["createBlock"])("div",o,[Object(a["createVNode"])(H,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(G,{span:24},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(H,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(G,{span:12},{default:Object(a["withCtx"])(()=>[l]),_:1}),Object(a["createVNode"])(G,{span:12,class:"text-align-right"},{default:Object(a["withCtx"])(()=>["single_rule"==z.ruleType?(Object(a["openBlock"])(),Object(a["createBlock"])("a",{key:0,class:"el-button el-button--primary is-plain",href:"/#/protection/"+z.domain+"/"+z.ruleType},"返回",8,["href"])):Object(a["createCommentVNode"])("",!0),"group_rule"==z.ruleType?(Object(a["openBlock"])(),Object(a["createBlock"])("a",{key:1,class:"el-button el-button--primary is-plain",href:"/#/group-protection/"+z.domain},"返回",8,["href"])):Object(a["createCommentVNode"])("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),Object(a["createVNode"])(I),b,Object(a["withDirectives"])(Object(a["createVNode"])(H,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(G,{span:24},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(Z,{model:z.webEngineForm,rules:A.rules,ref:"webEngineForm","label-width":"160px",class:"engine-form"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(Y,{label:"SQL注入防护"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(R,{modelValue:z.webEngineForm.sql_check,"onUpdate:modelValue":t[1]||(t[1]=e=>z.webEngineForm.sql_check=e)},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(K,{label:"block"},{default:Object(a["withCtx"])(()=>[r]),_:1}),Object(a["createVNode"])(K,{label:"reject_response"},{default:Object(a["withCtx"])(()=>[d]),_:1}),"true"==z.statusMimetic?(Object(a["openBlock"])(),Object(a["createBlock"])(K,{key:0,label:"mimetic_defense"},{default:Object(a["withCtx"])(()=>[i]),_:1})):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(K,{label:"watch"},{default:Object(a["withCtx"])(()=>[n]),_:1}),Object(a["createVNode"])(K,{label:"close"},{default:Object(a["withCtx"])(()=>[j]),_:1})]),_:1},8,["modelValue"])]),_:1}),Object(a["createVNode"])(Y,{label:"XSS防护"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(R,{modelValue:z.webEngineForm.xss_check,"onUpdate:modelValue":t[2]||(t[2]=e=>z.webEngineForm.xss_check=e)},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(K,{label:"block"},{default:Object(a["withCtx"])(()=>[O]),_:1}),Object(a["createVNode"])(K,{label:"reject_response"},{default:Object(a["withCtx"])(()=>[u]),_:1}),"true"==z.statusMimetic?(Object(a["openBlock"])(),Object(a["createBlock"])(K,{key:0,label:"mimetic_defense"},{default:Object(a["withCtx"])(()=>[s]),_:1})):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(K,{label:"watch"},{default:Object(a["withCtx"])(()=>[m]),_:1}),Object(a["createVNode"])(K,{label:"close"},{default:Object(a["withCtx"])(()=>[_]),_:1})]),_:1},8,["modelValue"])]),_:1}),Object(a["createVNode"])(Y,{label:"命令注入防护"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(R,{modelValue:z.webEngineForm.command_inject_check,"onUpdate:modelValue":t[3]||(t[3]=e=>z.webEngineForm.command_inject_check=e)},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(K,{label:"block"},{default:Object(a["withCtx"])(()=>[V]),_:1}),Object(a["createVNode"])(K,{label:"reject_response"},{default:Object(a["withCtx"])(()=>[w]),_:1}),"true"==z.statusMimetic?(Object(a["openBlock"])(),Object(a["createBlock"])(K,{key:0,label:"mimetic_defense"},{default:Object(a["withCtx"])(()=>[f]),_:1})):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(K,{label:"watch"},{default:Object(a["withCtx"])(()=>[h]),_:1}),Object(a["createVNode"])(K,{label:"close"},{default:Object(a["withCtx"])(()=>[p]),_:1})]),_:1},8,["modelValue"])]),_:1}),Object(a["createVNode"])(Y,{label:"WebShell上传防护"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(R,{modelValue:z.webEngineForm.webshell_update_check,"onUpdate:modelValue":t[4]||(t[4]=e=>z.webEngineForm.webshell_update_check=e)},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(K,{label:"block"},{default:Object(a["withCtx"])(()=>[x]),_:1}),Object(a["createVNode"])(K,{label:"reject_response"},{default:Object(a["withCtx"])(()=>[N]),_:1}),"true"==z.statusMimetic?(Object(a["openBlock"])(),Object(a["createBlock"])(K,{key:0,label:"mimetic_defense"},{default:Object(a["withCtx"])(()=>[g]),_:1})):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(K,{label:"watch"},{default:Object(a["withCtx"])(()=>[C]),_:1}),Object(a["createVNode"])(K,{label:"close"},{default:Object(a["withCtx"])(()=>[k]),_:1})]),_:1},8,["modelValue"])]),_:1}),Object(a["createVNode"])(Y,{label:"敏感文件泄露防护"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(R,{modelValue:z.webEngineForm.sensitive_file_check,"onUpdate:modelValue":t[5]||(t[5]=e=>z.webEngineForm.sensitive_file_check=e)},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(K,{label:"block"},{default:Object(a["withCtx"])(()=>[T]),_:1}),Object(a["createVNode"])(K,{label:"reject_response"},{default:Object(a["withCtx"])(()=>[y]),_:1}),"true"==z.statusMimetic?(Object(a["openBlock"])(),Object(a["createBlock"])(K,{key:0,label:"mimetic_defense"},{default:Object(a["withCtx"])(()=>[v]),_:1})):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(K,{label:"watch"},{default:Object(a["withCtx"])(()=>[B]),_:1}),Object(a["createVNode"])(K,{label:"close"},{default:Object(a["withCtx"])(()=>[E]),_:1})]),_:1},8,["modelValue"])]),_:1}),Object(a["createVNode"])(Y,{label:"路径穿越防护"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(R,{modelValue:z.webEngineForm.path_traversal_check,"onUpdate:modelValue":t[6]||(t[6]=e=>z.webEngineForm.path_traversal_check=e)},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(K,{label:"block"},{default:Object(a["withCtx"])(()=>[F]),_:1}),Object(a["createVNode"])(K,{label:"reject_response"},{default:Object(a["withCtx"])(()=>[M]),_:1}),"true"==z.statusMimetic?(Object(a["openBlock"])(),Object(a["createBlock"])(K,{key:0,label:"mimetic_defense"},{default:Object(a["withCtx"])(()=>[P]),_:1})):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(K,{label:"watch"},{default:Object(a["withCtx"])(()=>[U]),_:1}),Object(a["createVNode"])(K,{label:"close"},{default:Object(a["withCtx"])(()=>[S]),_:1})]),_:1},8,["modelValue"])]),_:1}),Object(a["createVNode"])(Y,{label:"高危Nday防护"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(R,{modelValue:z.webEngineForm.high_nday_check,"onUpdate:modelValue":t[7]||(t[7]=e=>z.webEngineForm.high_nday_check=e)},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(K,{label:"block"},{default:Object(a["withCtx"])(()=>[D]),_:1}),Object(a["createVNode"])(K,{label:"reject_response"},{default:Object(a["withCtx"])(()=>[L]),_:1}),"true"==z.statusMimetic?(Object(a["openBlock"])(),Object(a["createBlock"])(K,{key:0,label:"mimetic_defense"},{default:Object(a["withCtx"])(()=>[$]),_:1})):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(K,{label:"watch"},{default:Object(a["withCtx"])(()=>[q]),_:1}),Object(a["createVNode"])(K,{label:"close"},{default:Object(a["withCtx"])(()=>[J]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),W,Object(a["createVNode"])(H,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(G,{span:24},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(H,{type:"flex",class:"row-bg",justify:"space-between"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(G,{span:12},{default:Object(a["withCtx"])(()=>["single_rule"==z.ruleType?(Object(a["openBlock"])(),Object(a["createBlock"])("a",{key:0,class:"el-button el-button--primary is-plain",href:"/#/protection/"+z.domain+"/"+z.ruleType},"返回",8,["href"])):Object(a["createCommentVNode"])("",!0),"group_rule"==z.ruleType?(Object(a["openBlock"])(),Object(a["createBlock"])("a",{key:1,class:"el-button el-button--primary is-plain",href:"/#/group-protection/"+z.domain},"返回",8,["href"])):Object(a["createCommentVNode"])("",!0)]),_:1}),Object(a["createVNode"])(G,{span:12,class:"text-align-right"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(ee,{type:"primary",onClick:t[8]||(t[8]=e=>A.onClickPageOwaspSubmit("webEngineForm")),loading:z.loading},{default:Object(a["withCtx"])(()=>[Q]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512),[[te,z.loadingPage,void 0,{fullscreen:!0,lock:!0}]])])}var z=c("362c"),A=c("6c02"),G={mixins:[z["b"]],data(){return{loadingPage:!1,loading:!1,ruleType:this.$route.params.ruleType,domain:this.$route.params.domainUrl,webEngineForm:{},fileList:[],fileListVisible:!1,fileListValue:"",flagTag:!0,statusMimetic:"false"}},computed:{rules(){return{}}},mounted(){const e=Object(A["c"])();this.ruleType=e.params.ruleType,this.domain=e.params.domain,this.getData(),this.getMimetic()},methods:{getData(){var e=this,t="/waf/waf_get_web_engine_protection",c={domain:e.domain};"group_rule"==e.ruleType&&(t="/waf/waf_get_group_web_engine_protection",c={group_id:e.domain}),Object(z["a"])("post",t,c,(function(t){e.loadingPage=!1,e.webEngineForm=t.data.message}),(function(){e.loadingPage=!1}),"no-message")},getMimetic(){var e=this,t="/waf/waf_get_sys_mimetic_defense_conf";Object(z["a"])("get",t,{},(function(t){e.loadingPage=!1,e.statusMimetic=t.data.message.mimetic_defense}),(function(){e.loadingPage=!1}),"no-message")},onClickPageOwaspSubmit(e){var t=this,c="/waf/waf_edit_web_engine_protection";"group_rule"==t.ruleType?(c="/waf/waf_edit_group_web_engine_protection",this.webEngineForm.group_id=t.domain):this.webEngineForm.domain=t.domain,this.$refs[e].validate(e=>{e&&(t.loading=!0,Object(z["a"])("post",c,t.webEngineForm,(function(e){t.loading=!1,t.getData()}),(function(){t.loading=!1})))})}}},H=(c("7960"),c("d959")),I=c.n(H);const K=I()(G,[["render",X]]);t["default"]=K},6577:function(e,t,c){},7960:function(e,t,c){"use strict";c("6577")}}]);
//# sourceMappingURL=chunk-671e48de.f2e0079d.js.map